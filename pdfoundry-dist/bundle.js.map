{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/module/api/PDFEvents.ts","src/module/api/PDFUtil.ts","src/module/api/PDFoundryAPI.ts","src/module/app/PDFItemSheet.ts","src/module/app/PDFPlayerSelect.ts","src/module/cache/PDFCache.ts","src/module/main.ts","src/module/settings/PDFI18n.ts","src/module/settings/PDFSettings.ts","src/module/setup/PDFSetup.ts","src/module/socket/PDFSocketHandler.ts","src/module/socket/events/PDFPreloadEvent.ts","src/module/socket/events/PDFSetViewEvent.ts","src/module/socket/events/PDFSocketEvent.ts","src/module/viewer/PDFViewer.ts"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFEvent, CallbackSetup, CallbackViewer, CallbackPageRendered, CallbackPageChanging } from './types/EventHooks';\r\n\r\n/**\r\n * @private\r\n */\r\nclass EventStore {\r\n    private readonly _name: PDFEvent;\r\n    private readonly _callbacks: Function[];\r\n\r\n    constructor(name: PDFEvent) {\r\n        this._name = name;\r\n        this._callbacks = [];\r\n    }\r\n\r\n    /**\r\n     * Turn on an event callback for this event.\r\n     * @param callback The callback to turn on\r\n     */\r\n    public on(callback: Function) {\r\n        if (this._callbacks === undefined) {\r\n            return;\r\n        }\r\n\r\n        for (let i = 0; i < this._callbacks.length; i++) {\r\n            if (this._callbacks[i] === callback) return;\r\n        }\r\n\r\n        this._callbacks.push(callback);\r\n    }\r\n\r\n    /**\r\n     * Turn off an event callback for this event.\r\n     * @param callback The callback to turn off\r\n     */\r\n    public off(callback: Function) {\r\n        if (this._callbacks === undefined) {\r\n            return;\r\n        }\r\n\r\n        for (let i = this._callbacks.length; i >= 0; i--) {\r\n            if (this._callbacks[i] === callback) {\r\n                this._callbacks.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Fire an event and forward the args to all handlers\r\n     * @param args Any arguments that should be passed to handlers\r\n     */\r\n    public fire(...args) {\r\n        if (PDFEvents.DEBUG) {\r\n            console.debug(`<${this._name}>`);\r\n            console.debug(args);\r\n        }\r\n\r\n        for (const cb of this._callbacks) {\r\n            cb(...args);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Tracks and publishes events for PDF related occurrences. This class is callable through `ui.PDFoundry.events`.\r\n * All event properties of this class are accessible with the `on` method or via helper methods which contain additional\r\n * type hinting.\r\n */\r\nexport class PDFEvents {\r\n    /**\r\n     * If set to true, every event call will be logged. Functions much in the same manner that `CONFIG.debug.hooks` does.\r\n     */\r\n    public static DEBUG: boolean = false;\r\n\r\n    private static _EVENTS = {\r\n        init: new EventStore('init'),\r\n        setup: new EventStore('setup'),\r\n        ready: new EventStore('ready'),\r\n\r\n        viewerOpen: new EventStore('viewerOpen'),\r\n        viewerClose: new EventStore('viewerClose'),\r\n        viewerReady: new EventStore('viewerReady'),\r\n\r\n        viewerPageRendered: new EventStore('viewerPageRendered'),\r\n    };\r\n\r\n    // <editor-fold desc=\"Setup & Initialization Events\">\r\n\r\n    /**\r\n     * Called when all PDFoundry init stage tasks are done.\r\n     * @param cb\r\n     */\r\n    public static init(cb: CallbackSetup) {\r\n        return PDFEvents._EVENTS['init'].on(cb);\r\n    }\r\n\r\n    /**\r\n     * Called when all PDFoundry setup stage tasks are done.\r\n     * @param cb\r\n     */\r\n    public static setup(cb: CallbackSetup) {\r\n        return PDFEvents._EVENTS['setup'].on(cb);\r\n    }\r\n\r\n    /**\r\n     * Called when all PDFoundry ready stage tasks are done.\r\n     * @param cb\r\n     */\r\n    public static ready(cb: CallbackSetup) {\r\n        return PDFEvents._EVENTS['ready'].on(cb);\r\n    }\r\n\r\n    // </editor-fold>\r\n\r\n    // <editor-fold desc=\"Viewer Events\">\r\n\r\n    /**\r\n     * Called when a PDF viewer begins opening\r\n     * @param cb\r\n     */\r\n    public static viewerOpen(cb: CallbackViewer) {\r\n        return PDFEvents._EVENTS['viewerOpen'].on(cb);\r\n    }\r\n\r\n    /**\r\n     * Called when a PDF viewer begins closing\r\n     * @param cb\r\n     */\r\n    public static viewerClose(cb: CallbackViewer) {\r\n        return PDFEvents._EVENTS['viewerClose'].on(cb);\r\n    }\r\n\r\n    /**\r\n     * Called when a PDF viewer is ready to use\r\n     * @param cb\r\n     */\r\n    public static viewerReady(cb: CallbackViewer) {\r\n        return PDFEvents._EVENTS['viewerReady'].on(cb);\r\n    }\r\n\r\n    /**\r\n     * Called when a new page has finished rendering. The inner HTML of the div provided by this event will\r\n     * be replaced if the user scrolls the page out of view.\r\n     * @param cb\r\n     */\r\n    public static viewerPageRendered(cb: CallbackPageRendered) {\r\n        return PDFEvents._EVENTS['viewerPageRendered'].on(cb);\r\n    }\r\n\r\n    /**\r\n     * Called when the page is changed.\r\n     * @param cb\r\n     */\r\n    public static viewerPageChanging(cb: CallbackPageChanging) {\r\n        return PDFEvents._EVENTS['viewerPageChanging'].on(cb);\r\n    }\r\n\r\n    // </editor-fold>\r\n\r\n    /**\r\n     * Like {@link PDFEvents.on} but fires the event only once, then calls off. See individual events for callback\r\n     * function parameters.\r\n     * @param event\r\n     * @param callback\r\n     */\r\n    public static once(event: PDFEvent, callback: Function) {\r\n        const wrapper = function (...args) {\r\n            callback(args);\r\n            PDFEvents.off(event, wrapper);\r\n        };\r\n        PDFEvents.on(event, wrapper);\r\n    }\r\n\r\n    /**\r\n     * Turn on an event callback for an event.\r\n     * @param event The name of the event\r\n     * @param callback The callback to turn on\r\n     */\r\n    public static on(event: PDFEvent, callback: Function) {\r\n        PDFEvents._EVENTS[event].on(callback);\r\n    }\r\n\r\n    /**\r\n     * Turn off an event callback for an event.\r\n     * @param event The name of the event\r\n     * @param callback The callback to turn off\r\n     */\r\n    public static off(event: PDFEvent, callback: Function) {\r\n        PDFEvents._EVENTS[event].off(callback);\r\n    }\r\n\r\n    public static fire(event: PDFEvent, ...args) {\r\n        if (PDFEvents.DEBUG) {\r\n            console.debug(`Firing Event: ${event}`);\r\n            console.debug(args);\r\n        }\r\n        PDFEvents._EVENTS[event].fire(args);\r\n    }\r\n}\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFData } from './types/PDFData';\r\n\r\n/**\r\n * Contains various utility functions for common operations.\r\n */\r\nexport class PDFUtil {\r\n    /**\r\n     * Helper method. Convert a relative URL to a absolute URL\r\n     *  by prepending the window origin to the relative URL.\r\n     * @param dataUrl\r\n     */\r\n    public static getAbsoluteURL(dataUrl: string): string {\r\n        return `${window.origin}/${dataUrl}`;\r\n    }\r\n\r\n    /**\r\n     * Pull relevant data from an item, creating a {@link PDFData}.\r\n     * @param item The item to pull data from.\r\n     */\r\n    public static getPDFDataFromItem(item: Item): PDFData | null {\r\n        if (item === undefined || item === null) {\r\n            return null;\r\n        }\r\n\r\n        let { code, url, offset, cache } = item.data.data;\r\n        let name = item.name;\r\n\r\n        if (typeof offset === 'string') {\r\n            offset = parseInt(offset);\r\n        }\r\n\r\n        return {\r\n            name,\r\n            code,\r\n            url,\r\n            offset,\r\n            cache,\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Returns true if the URL starts with the origin.\r\n     * @param dataUrl A url.\r\n     */\r\n    public static validateAbsoluteURL(dataUrl: string): boolean {\r\n        return dataUrl.startsWith(window.origin);\r\n    }\r\n\r\n    /**\r\n     * Return all users ids except the active user\r\n     */\r\n    public static getUserIdsExceptMe() {\r\n        return game.users\r\n            .filter((user) => {\r\n                return user.id !== game.userId;\r\n            })\r\n            .map((user) => user.id);\r\n    }\r\n\r\n    /**\r\n     * Gets users with a role number between the provided lower inclusive and upper inclusive bounds.\r\n     * @param lower\r\n     * @param upper\r\n     */\r\n    public static getUserIdsBetweenRoles(lower: number, upper: number) {\r\n        return game.users\r\n            .filter((user) => {\r\n                return user.role >= lower && user.role <= upper;\r\n            })\r\n            .map((user) => user.id);\r\n    }\r\n\r\n    /**\r\n     * Gets users with a role number exactly matching the one provided.\r\n     * @param role\r\n     */\r\n    public static getUserIdsOfRole(role: number) {\r\n        return game.users\r\n            .filter((user) => {\r\n                return user.role === role;\r\n            })\r\n            .map((user) => user.id);\r\n    }\r\n\r\n    /**\r\n     * Gets users with a role number at least the one provided.\r\n     * @param role\r\n     */\r\n    public static getUserIdsAtLeastRole(role: number) {\r\n        return game.users\r\n            .filter((user) => {\r\n                return user.role >= role;\r\n            })\r\n            .map((user) => user.id);\r\n    }\r\n\r\n    /**\r\n     * Gets users with a role number at most the one provided.\r\n     * @param role\r\n     */\r\n    public static getUserIdsAtMostRole(role: number) {\r\n        return game.users\r\n            .filter((user) => {\r\n                return user.role <= role;\r\n            })\r\n            .map((user) => user.id);\r\n    }\r\n\r\n    /**\r\n     * Checks if a remote file exists at the specified path. That is, if the URL is valid. This does not guarantee a\r\n     * valid file exists at that location. For example, an HTML file will result in true but not be a valid PDF.\r\n     * @param path\r\n     */\r\n    public static fileExists(path: string): Promise<boolean> {\r\n        return new Promise<boolean>((resolve, reject) => {\r\n            $.ajax({\r\n                url: path,\r\n                type: 'HEAD',\r\n                success: function () {\r\n                    resolve(true);\r\n                },\r\n                error: function () {\r\n                    resolve(false);\r\n                },\r\n            });\r\n        });\r\n    }\r\n}\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFSettings } from '../settings/PDFSettings';\r\nimport { PDFViewer } from '../viewer/PDFViewer';\r\nimport { PDFCache } from '../cache/PDFCache';\r\nimport { PDFEvents } from './PDFEvents';\r\nimport { PDFUtil } from './PDFUtil';\r\nimport { PDFData } from './types/PDFData';\r\n\r\ntype ItemComparer = (item: Item) => boolean;\r\n\r\nasync function _handleOpen(viewer: PDFViewer, url: string, page: number, cache: boolean) {\r\n    if (cache) {\r\n        const cachedBytes = await PDFCache.getCache(url);\r\n        // If we have a cache hit open the cached data\r\n        if (cachedBytes) {\r\n            await viewer.open(cachedBytes, page);\r\n        } else {\r\n            // Otherwise we should open it by url\r\n            await viewer.open(url, page);\r\n            // And when the download is complete set the cache\r\n            viewer.download().then((bytes) => {\r\n                PDFCache.setCache(url, bytes);\r\n            });\r\n        }\r\n    } else {\r\n        await viewer.open(url, page);\r\n    }\r\n}\r\n\r\n/**\r\n * The PDFoundry API <br>\r\n *\r\n * You can access the API with `ui.PDFoundry`. Note the primary way to observe behavior of the PDF viewer is to use\r\n * the provided {@link PDFEvents} class.\r\n */\r\nexport class PDFoundryAPI {\r\n    /**\r\n     * A reference to the static {@link PDFEvents} class.\r\n     */\r\n    public static get events() {\r\n        return PDFEvents;\r\n    }\r\n\r\n    /**\r\n     * A reference to the static {@link PDFUtil} class.\r\n     */\r\n    public static get util() {\r\n        return PDFUtil;\r\n    }\r\n\r\n    // <editor-fold desc=\"GetPDFData Methods\">\r\n\r\n    /**\r\n     * Helper method. Alias for {@link PDFoundryAPI.getPDFData} with a\r\n     *  comparer that searches by PDF Code.\r\n     * @param code Which code to search for a PDF with.\r\n     */\r\n    public static getPDFDataByCode(code: string): PDFData | null {\r\n        return PDFoundryAPI.getPDFData((item) => {\r\n            return item.data.data.code === code;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Helper method. Alias for {@link PDFoundryAPI.getPDFData} with a\r\n     *  comparer that searches by PDF Name.\r\n     * @param name Which name to search for a PDF with.\r\n     * @param caseInsensitive If a case insensitive search should be done.\r\n     */\r\n    public static getPDFDataByName(name: string, caseInsensitive: boolean = true): PDFData | null {\r\n        if (caseInsensitive) {\r\n            return PDFoundryAPI.getPDFData((item) => {\r\n                return item.name.toLowerCase() === name.toLowerCase();\r\n            });\r\n        } else {\r\n            return PDFoundryAPI.getPDFData((item) => {\r\n                return item.name === name;\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Finds a PDF entity created by the user and constructs a\r\n     *  {@link PDFData} object of the resulting PDF's data.\r\n     * @param comparer A comparison function that will be used.\r\n     */\r\n    public static getPDFData(comparer: ItemComparer): PDFData | null {\r\n        const pdf: Item = game.items.find((item: Item) => {\r\n            return item.type === PDFSettings.PDF_ENTITY_TYPE && comparer(item);\r\n        });\r\n\r\n        return PDFUtil.getPDFDataFromItem(pdf);\r\n    }\r\n\r\n    // </editor-fold>\r\n\r\n    // <editor-fold desc=\"OpenPDF Methods\">\r\n\r\n    /**\r\n     * Open the PDF with the provided code to the specified page.\r\n     * Helper for {@link getPDFDataByCode} then {@link openPDF}.\r\n     */\r\n    public static async openPDFByCode(code: string, page: number = 1) {\r\n        const pdf = this.getPDFDataByCode(code);\r\n\r\n        if (pdf === null) {\r\n            const error = game.i18n.localize('PDFOUNDRY.ERROR.NoPDFWithCode');\r\n\r\n            if (PDFSettings.NOTIFICATIONS) {\r\n                ui.notifications.error(error);\r\n            }\r\n\r\n            return Promise.reject(error);\r\n        }\r\n\r\n        return this.openPDF(pdf, page);\r\n    }\r\n\r\n    /**\r\n     * Open the PDF with the provided code to the specified page.\r\n     * Helper for {@link getPDFDataByCode} then {@link openPDF}.\r\n     */\r\n    public static async openPDFByName(name: string, page: number = 1) {\r\n        const pdf = this.getPDFDataByName(name);\r\n\r\n        if (pdf === null) {\r\n            const message = game.i18n.localize('PDFOUNDRY.ERROR.NoPDFWithName');\r\n            const error = new Error(message);\r\n\r\n            if (PDFSettings.NOTIFICATIONS) {\r\n                ui.notifications.error(error.message);\r\n            }\r\n\r\n            return Promise.reject(error);\r\n        }\r\n\r\n        return this.openPDF(pdf, page);\r\n    }\r\n\r\n    /**\r\n     * Open the provided {@link PDFData} to the specified page.\r\n     * @param pdf The PDF to open. See {@link PDFoundryAPI.getPDFData}.\r\n     * @param page The page to open the PDF to.\r\n     */\r\n    public static async openPDF(pdf: PDFData, page: number = 1) {\r\n        let { url, offset, cache } = pdf;\r\n\r\n        if (typeof offset === 'string') {\r\n            offset = parseInt(offset);\r\n        }\r\n\r\n        if (!PDFUtil.validateAbsoluteURL(url)) {\r\n            url = PDFUtil.getAbsoluteURL(url);\r\n        }\r\n\r\n        const viewer = new PDFViewer(pdf);\r\n        viewer.render(true);\r\n\r\n        await _handleOpen(viewer, url, page + offset, cache);\r\n\r\n        return viewer;\r\n    }\r\n\r\n    /**\r\n     * Open a URL as a PDF.\r\n     * @param url The URL to open (must be absolute).\r\n     * @param page Which page to open to. Must be >= 1.\r\n     * @param cache If URL based caching should be used.\r\n     */\r\n    public static async openURL(url: string, page: number = 1, cache: boolean = true): Promise<PDFViewer> {\r\n        if (isNaN(page) || page <= 0) {\r\n            throw new Error(`Page must be > 0, but ${page} was given.`);\r\n        }\r\n\r\n        if (!PDFUtil.validateAbsoluteURL(url)) {\r\n            url = PDFUtil.getAbsoluteURL(url);\r\n        }\r\n\r\n        const viewer = new PDFViewer();\r\n        viewer.render(true);\r\n\r\n        await _handleOpen(viewer, url, page, cache);\r\n\r\n        return viewer;\r\n    }\r\n\r\n    /**\r\n     * Shows the user manual to the active user.\r\n     */\r\n    public static async showHelp() {\r\n        await game.user.setFlag(PDFSettings.EXTERNAL_SYSTEM_NAME, PDFSettings.HELP_SEEN_KEY, true);\r\n\r\n        const lang = game.i18n.lang;\r\n        let manualPath = `${window.origin}/systems/${PDFSettings.EXTERNAL_SYSTEM_NAME}/${PDFSettings.DIST_FOLDER}/assets/manual/${lang}/manual.pdf`;\r\n        const manualExists = await PDFUtil.fileExists(manualPath);\r\n\r\n        if (!manualExists) {\r\n            manualPath = `${window.origin}/systems/${PDFSettings.EXTERNAL_SYSTEM_NAME}/${PDFSettings.DIST_FOLDER}/assets/manual/en/manual.pdf`;\r\n        }\r\n\r\n        const pdfData: PDFData = {\r\n            name: game.i18n.localize('PDFOUNDRY.MANUAL.Name'),\r\n            code: '',\r\n            offset: 0,\r\n            url: manualPath,\r\n            cache: false,\r\n        };\r\n\r\n        return PDFoundryAPI.openPDF(pdfData);\r\n    }\r\n\r\n    // </editor-fold>\r\n}\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFSettings } from '../settings/PDFSettings';\r\nimport { PDFoundryAPI } from '../api/PDFoundryAPI';\r\n\r\n/**\r\n * Extends the base ItemSheet for linked PDF viewing.\r\n * @private\r\n */\r\nexport class PDFItemSheet extends ItemSheet {\r\n    static get defaultOptions() {\r\n        const options = super.defaultOptions;\r\n        options.classes = ['sheet', 'item'];\r\n        options.width = 650;\r\n        options.height = 'auto';\r\n        options.template = `systems/${PDFSettings.EXTERNAL_SYSTEM_NAME}/${PDFSettings.DIST_FOLDER}/templates/sheet/pdf-sheet.html`;\r\n        return options;\r\n    }\r\n\r\n    /**\r\n     * Helper method to get a id in the html form\r\n     * html ids are prepended with the id of the item to preserve uniqueness\r\n     *  which is mandatory to allow multiple forms to be open\r\n     * @param html\r\n     * @param id\r\n     */\r\n    private _getByID(html: JQuery<HTMLElement>, id: string): JQuery<HTMLElement> {\r\n        return html.parent().parent().find(`#${this.item._id}-${id}`);\r\n    }\r\n\r\n    protected _getHeaderButtons(): any[] {\r\n        const buttons = super._getHeaderButtons();\r\n        buttons.unshift({\r\n            class: 'pdf-sheet-manual',\r\n            icon: 'fas fa-question-circle',\r\n            label: 'Help',\r\n            onclick: () => PDFoundryAPI.showHelp(),\r\n        });\r\n        //TODO: Standardize this to function w/ the Viewer one\r\n        buttons.unshift({\r\n            class: 'pdf-sheet-github',\r\n            icon: 'fas fa-external-link-alt',\r\n            label: 'PDFoundry',\r\n            onclick: () => window.open('https://github.com/Djphoenix719/PDFoundry', '_blank'),\r\n        });\r\n        return buttons;\r\n    }\r\n\r\n    protected activateListeners(html: JQuery<HTMLElement>): void {\r\n        super.activateListeners(html);\r\n\r\n        const urlInput = this._getByID(html, 'data\\\\.url');\r\n        const offsetInput = this._getByID(html, 'data\\\\.offset');\r\n\r\n        // Block enter from displaying the PDF\r\n        html.find('input').on('keypress', function (event) {\r\n            if (event.key === 'Enter') {\r\n                event.preventDefault();\r\n            }\r\n        });\r\n\r\n        // Test button\r\n        this._getByID(html, 'pdf-test').on('click', function (event) {\r\n            event.preventDefault();\r\n\r\n            let urlValue = urlInput.val();\r\n            let offsetValue = offsetInput.val();\r\n\r\n            if (urlValue === null || urlValue === undefined) return;\r\n            if (offsetValue === null || offsetValue === undefined) return;\r\n\r\n            urlValue = `${window.location.origin}/${urlValue}`;\r\n\r\n            if (offsetValue.toString().trim() === '') {\r\n                offsetValue = 0;\r\n            }\r\n            offsetValue = parseInt(offsetValue as string);\r\n\r\n            PDFoundryAPI.openURL(urlValue, 5 + offsetValue, false);\r\n        });\r\n\r\n        // Browse button\r\n        this._getByID(html, 'pdf-browse').on('click', async function (event) {\r\n            event.preventDefault();\r\n\r\n            const fp = new FilePicker({});\r\n            // @ts-ignore TODO: foundry-pc-types\r\n            fp.extensions = ['.pdf'];\r\n            fp.field = urlInput[0];\r\n\r\n            let urlValue = urlInput.val();\r\n            if (urlValue !== undefined) {\r\n                await fp.browse(urlValue.toString().trim());\r\n            }\r\n\r\n            fp.render(true);\r\n        });\r\n    }\r\n}\r\n","import { PDFUtil } from '../api/PDFUtil';\r\nimport { PDFSettings } from '../settings/PDFSettings';\r\nimport { PDFData } from '../api/types/PDFData';\r\n\r\nexport type PDFPlayerSelectCallback = (ids: []) => void;\r\nexport class PDFPlayerSelect extends Application {\r\n    static get defaultOptions() {\r\n        const options = super.defaultOptions;\r\n        options.classes = ['sheet', 'item'];\r\n        options.template = `systems/${PDFSettings.EXTERNAL_SYSTEM_NAME}/${PDFSettings.DIST_FOLDER}/templates/app/pdf-player-select.html`;\r\n        options.width = 'auto';\r\n        options.height = 'auto';\r\n        options.title = game.i18n.localize('PDFOUNDRY.VIEWER.SelectPlayers');\r\n        return options;\r\n    }\r\n\r\n    private readonly ids;\r\n    private readonly cb;\r\n\r\n    constructor(ids: string[], cb: PDFPlayerSelectCallback, options?: ApplicationOptions) {\r\n        super(options);\r\n\r\n        this.ids = ids;\r\n        this.cb = cb;\r\n    }\r\n\r\n    getData(options?: any): any | Promise<any> {\r\n        const data = super.getData(options);\r\n\r\n        const users: any[] = [];\r\n        for (const id of this.ids) {\r\n            users.push({\r\n                name: game.users.get(id).name,\r\n                id,\r\n            });\r\n        }\r\n\r\n        users.sort((a, b) => a.name.localeCompare(b.name));\r\n\r\n        data['users'] = users;\r\n        return data;\r\n    }\r\n\r\n    protected activateListeners(html: JQuery<HTMLElement> | HTMLElement): void {\r\n        super.activateListeners(html);\r\n\r\n        const button = $(html).find('#confirm');\r\n        button.on('click', () => {\r\n            this.cb(this.collectIds(html));\r\n            this.close();\r\n        });\r\n    }\r\n\r\n    private collectIds(html: JQuery<HTMLElement> | HTMLElement): string[] {\r\n        const ids: string[] = [];\r\n        const checkboxes = $(html).find('input[type=checkbox]');\r\n        for (let i = 0; i < checkboxes.length; i++) {\r\n            const checkbox = $(checkboxes[i]);\r\n            if (checkbox.prop('checked')) {\r\n                ids.push(checkbox.prop('id'));\r\n            }\r\n        }\r\n        return ids;\r\n    }\r\n}\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nimport { PDFViewer } from '../viewer/PDFViewer';\r\nimport { PDFSettings } from '../settings/PDFSettings';\r\n\r\n/**\r\n * An error that occurs during cache operations\r\n */\r\nexport class CacheError extends Error {\r\n    constructor(index: string, store: string, message?: string) {\r\n        super(`Error in ${index}>${store}: ${message}`);\r\n    }\r\n}\r\n\r\n/**\r\n * Class that deals with getting/setting from an indexed db\r\n * Mostly exists to separate logic for the PDFCache from logic\r\n * dealing with the database\r\n * @private\r\n */\r\nclass IDBHelper {\r\n    private _version: number;\r\n\r\n    private readonly _indexName: string;\r\n    private readonly _storeNames: string[];\r\n\r\n    private _db: IDBDatabase;\r\n\r\n    public static async createAndOpen(indexName: string, storeNames: string[], version: number) {\r\n        const helper = new IDBHelper(indexName, storeNames, version);\r\n        await helper.open();\r\n        return helper;\r\n    }\r\n\r\n    public get ready() {\r\n        return this._db !== undefined;\r\n    }\r\n\r\n    public constructor(indexName: string, storeNames: string[], version: number) {\r\n        this._indexName = `${indexName}`;\r\n        this._storeNames = storeNames;\r\n        this._version = version;\r\n    }\r\n\r\n    private newTransaction(storeName: string) {\r\n        const transaction = this._db.transaction(storeName, 'readwrite');\r\n        const store = transaction.objectStore(storeName);\r\n        return { transaction, store };\r\n    }\r\n\r\n    public open(): Promise<void> {\r\n        const that = this;\r\n        return new Promise<void>(function (resolve, reject) {\r\n            const request = indexedDB.open(that._indexName, that._version);\r\n            request.onsuccess = function (event) {\r\n                that._db = this.result;\r\n                resolve();\r\n            };\r\n            request.onupgradeneeded = function (event) {\r\n                that._db = this.result;\r\n                for (let i = 0; i < that._storeNames.length; i++) {\r\n                    try {\r\n                        // Create object store if it doesn't exist\r\n                        that._db.createObjectStore(that._storeNames[i], {});\r\n                    } catch (error) {\r\n                        // Otherwise pass\r\n                    }\r\n                }\r\n                resolve();\r\n            };\r\n            request.onerror = function (event) {\r\n                // @ts-ignore\r\n                reject(event.target.error);\r\n            };\r\n        });\r\n    }\r\n\r\n    public set(key: IDBValidKey, value: any, storeName: string, force: boolean = false): Promise<void> {\r\n        return new Promise<void>((resolve, reject) => {\r\n            if (!this._db) {\r\n                throw new CacheError(this._indexName, storeName, 'Database is not initialized.');\r\n            } else {\r\n                const that = this;\r\n                let { transaction, store } = this.newTransaction(storeName);\r\n\r\n                // Propagate errors upwards, otherwise they fail silently\r\n                transaction.onerror = function (event) {\r\n                    // @ts-ignore\r\n                    reject(event.target.error);\r\n                };\r\n\r\n                const keyRequest = store.getKey(key);\r\n                keyRequest.onsuccess = function (event) {\r\n                    // key already exists in the store\r\n                    if (keyRequest.result) {\r\n                        // should we force the new value by deleting the old?\r\n                        if (force) {\r\n                            that.del(key, storeName).then(() => {\r\n                                ({ transaction, store } = that.newTransaction(storeName));\r\n                                store.add(value, key);\r\n                                resolve();\r\n                            });\r\n                        } else {\r\n                            throw new CacheError(that._indexName, storeName, `Key ${key} already exists.`);\r\n                        }\r\n                    } else {\r\n                        store.add(value, key);\r\n                        resolve();\r\n                    }\r\n                };\r\n            }\r\n        });\r\n    }\r\n\r\n    public get(key: IDBValidKey, storeName: string): Promise<any> {\r\n        return new Promise<void>((resolve, reject) => {\r\n            if (!this._db) {\r\n                throw new CacheError(this._indexName, storeName, 'Database is not initialized.');\r\n            } else {\r\n                let { transaction, store } = this.newTransaction(storeName);\r\n\r\n                // Propagate errors upwards, otherwise they fail silently\r\n                transaction.onerror = function (event) {\r\n                    // @ts-ignore\r\n                    reject(event.target.error);\r\n                };\r\n\r\n                const getRequest = store.get(key);\r\n                getRequest.onsuccess = function (event) {\r\n                    resolve(this.result);\r\n                };\r\n\r\n                getRequest.onerror = function (event) {\r\n                    // @ts-ignore\r\n                    reject(event.target.error);\r\n                };\r\n            }\r\n        });\r\n    }\r\n\r\n    public del(key: IDBValidKey, storeName: string): Promise<void> {\r\n        return new Promise<void>((resolve, reject) => {\r\n            try {\r\n                const { transaction, store } = this.newTransaction(storeName);\r\n\r\n                transaction.onerror = function (event) {\r\n                    // @ts-ignore\r\n                    reject(event.target.error);\r\n                };\r\n                transaction.oncomplete = function (event) {\r\n                    resolve();\r\n                };\r\n\r\n                store.delete(key);\r\n            } catch (error) {\r\n                reject(error);\r\n            }\r\n        });\r\n    }\r\n\r\n    public keys(storeName: string): Promise<IDBValidKey[]> {\r\n        return new Promise<IDBValidKey[]>((resolve, reject) => {\r\n            try {\r\n                const { transaction, store } = this.newTransaction(storeName);\r\n                const keysRequest = store.getAllKeys();\r\n\r\n                keysRequest.onsuccess = function () {\r\n                    resolve(keysRequest.result);\r\n                };\r\n                keysRequest.onerror = function (event) {\r\n                    // @ts-ignore\r\n                    reject(event.target.error);\r\n                };\r\n\r\n                return;\r\n            } catch (error) {\r\n                reject(error);\r\n            }\r\n        });\r\n    }\r\n\r\n    public clr(storeName: string): Promise<void> {\r\n        return new Promise<void>((resolve, reject) => {\r\n            try {\r\n                const { store } = this.newTransaction(storeName);\r\n                const keys = store.getAllKeys();\r\n                keys.onsuccess = (result) => {\r\n                    const promises: Promise<void>[] = [];\r\n                    for (const key of keys.result) {\r\n                        promises.push(this.del(key, storeName));\r\n                    }\r\n                    Promise.all(promises).then(() => {\r\n                        resolve();\r\n                    });\r\n                };\r\n            } catch (error) {\r\n                reject(error);\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Meta information about a cache entry\r\n */\r\ntype CacheMeta = {\r\n    /**\r\n     * The size in bytes this cache entry takes up.\r\n     */\r\n    size: number;\r\n    /**\r\n     * The date the cache was last accessed, represented by a ISO string.\r\n     */\r\n    dateAccessed: string;\r\n};\r\n\r\n/**\r\n * Handles caching for PDFs\r\n */\r\nexport class PDFCache {\r\n    // <editor-fold desc=\"Static Properties\">\r\n    /**\r\n     * Max size of the cache for the active user, defaults to 256 MB.\r\n     */\r\n    public static get MAX_BYTES() {\r\n        return game.settings.get(PDFSettings.EXTERNAL_SYSTEM_NAME, 'CacheSize') * 2 ** 20;\r\n    }\r\n\r\n    private static readonly IDB_NAME: string = 'PDFoundry';\r\n    private static readonly IDB_VERSION: number = 1;\r\n\r\n    private static readonly CACHE: string = `Cache`;\r\n    private static readonly META: string = `Meta`;\r\n\r\n    private static _cacheHelper: IDBHelper;\r\n    // </editor-fold>\r\n\r\n    public static async initialize() {\r\n        PDFCache._cacheHelper = await IDBHelper.createAndOpen(PDFCache.IDB_NAME, [PDFCache.CACHE, PDFCache.META], PDFCache.IDB_VERSION);\r\n    }\r\n\r\n    /**\r\n     * Get meta information about a provided key (url).\r\n     * @param key\r\n     */\r\n    public static async getMeta(key: string): Promise<CacheMeta | null> {\r\n        try {\r\n            return await PDFCache._cacheHelper.get(key, PDFCache.META);\r\n        } catch (error) {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set meta information about a provided key (url). See {@link CacheMeta}.\r\n     * @param key\r\n     * @param meta\r\n     */\r\n    public static async setMeta(key: string, meta: CacheMeta): Promise<void> {\r\n        await PDFCache._cacheHelper.set(key, meta, PDFCache.META, true);\r\n    }\r\n\r\n    /**\r\n     * Get the byte array representing the key (url) from the user's cache.\r\n     * @param key\r\n     */\r\n    public static async getCache(key: string): Promise<Uint8Array | null> {\r\n        try {\r\n            const bytes = await PDFCache._cacheHelper.get(key, PDFCache.CACHE);\r\n            const meta: CacheMeta = {\r\n                dateAccessed: new Date().toISOString(),\r\n                size: bytes.length,\r\n            };\r\n            await PDFCache.setMeta(key, meta);\r\n\r\n            return bytes;\r\n        } catch (error) {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set the value of the cache for the specific key (url) to the provided byte array.\r\n     * @param key\r\n     * @param bytes\r\n     */\r\n    public static async setCache(key: string, bytes: Uint8Array) {\r\n        const meta: CacheMeta = {\r\n            dateAccessed: new Date().toISOString(),\r\n            size: bytes.length,\r\n        };\r\n\r\n        await PDFCache._cacheHelper.set(key, bytes, PDFCache.CACHE, true);\r\n        await PDFCache.setMeta(key, meta);\r\n        await this.prune();\r\n    }\r\n\r\n    /**\r\n     * Preload the PDF at the specified key (url), caching it immediately.\r\n     * @param key\r\n     */\r\n    public static preload(key: string): Promise<void> {\r\n        return new Promise<void>(async (resolve, reject) => {\r\n            const cachedBytes = await PDFCache.getCache(key);\r\n            if (cachedBytes !== null && cachedBytes.byteLength > 0) {\r\n                resolve();\r\n                return;\r\n            }\r\n\r\n            const response = await fetch(key);\r\n            if (response.ok) {\r\n                const fetchedBytes = new Uint8Array(await response.arrayBuffer());\r\n                if (fetchedBytes.byteLength > 0) {\r\n                    await PDFCache.setCache(key, fetchedBytes);\r\n                    resolve();\r\n                    return;\r\n                } else {\r\n                    reject('Fetch failed.');\r\n                }\r\n            } else {\r\n                reject('Fetch failed.');\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Prune the active user's cache until it is below the user's cache size limit.\r\n     */\r\n    public static async prune() {\r\n        const keys = await this._cacheHelper.keys(PDFCache.META);\r\n\r\n        let totalBytes = 0;\r\n        let metas: any[] = [];\r\n        for (const key of keys) {\r\n            const meta = await this._cacheHelper.get(key, PDFCache.META);\r\n            meta.dateAccessed = Date.parse(meta.dateAccessed);\r\n            meta.size = parseInt(meta.size);\r\n\r\n            totalBytes += meta.size;\r\n\r\n            metas.push({\r\n                key,\r\n                meta,\r\n            });\r\n        }\r\n\r\n        metas = metas.sort((a, b) => {\r\n            return a.meta.dateAccessed - b.meta.dateAccessed;\r\n        });\r\n\r\n        for (let i = 0; i < metas.length; i++) {\r\n            if (totalBytes < PDFCache.MAX_BYTES) {\r\n                break;\r\n            }\r\n\r\n            const next = metas[i];\r\n\r\n            await this._cacheHelper.del(next.key, PDFCache.META);\r\n            await this._cacheHelper.del(next.key, PDFCache.CACHE);\r\n\r\n            totalBytes -= next.meta.size;\r\n        }\r\n    }\r\n}\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFSetup } from './setup/PDFSetup';\r\nimport { PDFCache } from './cache/PDFCache';\r\nimport { PDFEvents } from './api/PDFEvents';\r\nimport { PDFI18n } from './settings/PDFI18n';\r\nimport { PDFSettings } from './settings/PDFSettings';\r\nimport { PDFSocketHandler } from './socket/PDFSocketHandler';\r\nimport { PDFoundryAPI } from './api/PDFoundryAPI';\r\n\r\nPDFSetup.registerSystem();\r\nPDFSetup.registerAPI();\r\n\r\n/**\r\n * @private\r\n */\r\nconst init = async () => {\r\n    // Inject the css into the page\r\n    PDFSetup.registerCSS();\r\n\r\n    PDFEvents.fire('init', PDFoundryAPI);\r\n\r\n    await setup();\r\n};\r\n/**\r\n * @private\r\n */\r\nconst setup = async () => {\r\n    // Initialize the cache system, creating the DB\r\n    await PDFCache.initialize();\r\n    // Load the relevant internationalization file.\r\n    await PDFI18n.initialize();\r\n\r\n    PDFEvents.fire('setup', PDFoundryAPI);\r\n};\r\n/**\r\n * @private\r\n */\r\nconst ready = async () => {\r\n    // Register the PDF sheet with the class picker, unregister others\r\n    PDFSetup.foundryConfig();\r\n    // Initialize the settings\r\n    await PDFSettings.registerSettings();\r\n\r\n    PDFSetup.userLogin();\r\n\r\n    PDFSocketHandler.registerHandlers();\r\n\r\n    PDFEvents.fire('ready', PDFoundryAPI);\r\n};\r\n\r\nHooks.once('setup', init);\r\nHooks.once('ready', ready);\r\n\r\n// <editor-fold desc=\"Persistent Hooks\">\r\n\r\n// preCreateItem - Setup default values for a new PDFoundry_PDF\r\nHooks.on('preCreateItem', PDFSetup.preCreateItem);\r\n// getItemDirectoryEntryContext - Setup context menu for 'Open PDF' links\r\nHooks.on('getItemDirectoryEntryContext', PDFSetup.getItemContextOptions);\r\n// renderSettings - Inject a 'Open Manual' button into help section\r\nHooks.on('renderSettings', PDFSetup.onRenderSettings);\r\n\r\n// </editor-fold>\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFSettings } from './PDFSettings';\r\n\r\n/**\r\n * Localization helper\r\n * @private\r\n */\r\nexport class PDFI18n {\r\n    /**\r\n     * Load the localization file for the user's language.\r\n     */\r\n    public static async initialize() {\r\n        const lang = game.i18n.lang;\r\n        // user's language path\r\n        const u_path = `systems/${PDFSettings.EXTERNAL_SYSTEM_NAME}/${PDFSettings.DIST_FOLDER}/locale/${lang}/config.json`;\r\n        // english fallback path\r\n        const f_path = `systems/${PDFSettings.EXTERNAL_SYSTEM_NAME}/${PDFSettings.DIST_FOLDER}/locale/en/config.json`;\r\n\r\n        let json;\r\n        try {\r\n            json = await $.getJSON(u_path);\r\n        } catch (error) {\r\n            // if no translation exits for the users locale the fallback\r\n            json = await $.getJSON(f_path);\r\n        }\r\n\r\n        for (const key of Object.keys(json)) {\r\n            game.i18n.translations[key] = json[key];\r\n        }\r\n\r\n        // setup the fallback as english so partial translations do not display keys\r\n        let fb_json = await $.getJSON(f_path);\r\n        for (const key of Object.keys(fb_json)) {\r\n            // @ts-ignore\r\n            game.i18n._fallback[key] = json[key];\r\n        }\r\n    }\r\n}\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFoundryAPI } from '../api/PDFoundryAPI';\r\nimport { PDFCache } from '../cache/PDFCache';\r\nimport { PDFUtil } from '../api/PDFUtil';\r\nimport { PDFPreloadEvent } from '../socket/events/PDFPreloadEvent';\r\n\r\n/**\r\n * Internal settings and helper methods for PDFoundry.\r\n * @private\r\n */\r\nexport class PDFSettings {\r\n    /**\r\n     * Are feedback notifications enabled? Disable if you wish\r\n     *  to handle them yourself.\r\n     */\r\n    public static NOTIFICATIONS: boolean = true;\r\n\r\n    public static DIST_FOLDER: string = 'pdfoundry-dist';\r\n    public static EXTERNAL_SYSTEM_NAME: string = '../modules/pdfoundry';\r\n    public static INTERNAL_MODULE_NAME: string = 'pdfoundry';\r\n    public static PDF_ENTITY_TYPE: string = 'PDFoundry_PDF';\r\n\r\n    public static SETTING_EXISTING_VIEWER = 'ShowInExistingViewer';\r\n    public static SETTING_CACHE_SIZE = 'CacheSize';\r\n\r\n    public static HELP_SEEN_KEY: string = 'PDFoundry_HelpSeen';\r\n\r\n    public static get SOCKET_NAME() {\r\n        return `system.${PDFSettings.EXTERNAL_SYSTEM_NAME}`;\r\n    }\r\n\r\n    public static registerSettings() {\r\n        PDFSettings.register(PDFSettings.SETTING_CACHE_SIZE, {\r\n            name: game.i18n.localize('PDFOUNDRY.SETTINGS.CacheSizeName'),\r\n            scope: 'user',\r\n            type: Number,\r\n            hint: game.i18n.localize('PDFOUNDRY.SETTINGS.CacheSizeHint'),\r\n            default: 256,\r\n            config: true,\r\n            onChange: async (mb) => {\r\n                mb = Math.round(mb);\r\n                mb = Math.max(mb, 64);\r\n                mb = Math.min(mb, 1024);\r\n                await PDFSettings.set(PDFSettings.SETTING_CACHE_SIZE, mb);\r\n            },\r\n        });\r\n\r\n        PDFSettings.register(PDFSettings.SETTING_EXISTING_VIEWER, {\r\n            name: game.i18n.localize('PDFOUNDRY.SETTINGS.ShowInExistingViewerName'),\r\n            scope: 'user',\r\n            type: Boolean,\r\n            hint: game.i18n.localize('PDFOUNDRY.SETTINGS.ShowInExistingViewerHint'),\r\n            default: true,\r\n            config: true,\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Wrapper around game.settings.register. Ensures scope is correct.\r\n     * @param key\r\n     * @param data\r\n     */\r\n    public static register(key: string, data: any) {\r\n        game.settings.register(PDFSettings.EXTERNAL_SYSTEM_NAME, key, data);\r\n    }\r\n\r\n    /**\r\n     * Wrapper around game.settings.get. Ensures scope is correct.\r\n     * @param key\r\n     */\r\n    public static get(key: string) {\r\n        return game.settings.get(PDFSettings.EXTERNAL_SYSTEM_NAME, key);\r\n    }\r\n\r\n    /**\r\n     * Wrapper around game.settings.set. Ensures scope is correct.\r\n     * @param key\r\n     * @param value\r\n     */\r\n    public static async set(key: string, value: any) {\r\n        return game.settings.set(PDFSettings.EXTERNAL_SYSTEM_NAME, key, value);\r\n    }\r\n}\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFSettings } from '../settings/PDFSettings';\r\nimport { PDFItemSheet } from '../app/PDFItemSheet';\r\nimport { PDFoundryAPI } from '../api/PDFoundryAPI';\r\nimport { PDFUtil } from '../api/PDFUtil';\r\nimport { PDFPreloadEvent } from '../socket/events/PDFPreloadEvent';\r\nimport { PDFCache } from '../cache/PDFCache';\r\n\r\n// TODO: Utilities for get/set user flags\r\n/**\r\n * A collection of methods used for setting up the API & system state.\r\n * @private\r\n */\r\nexport class PDFSetup {\r\n    /**\r\n     * Register the PDFoundry APi on the UI\r\n     */\r\n    public static registerAPI() {\r\n        ui['PDFoundry'] = PDFoundryAPI;\r\n    }\r\n\r\n    /**\r\n     * Inject the CSS file into the header, so it doesn't have to be referenced in the system.json\r\n     */\r\n    public static registerCSS() {\r\n        $('head').append(\r\n            $(`<link href=\"systems/${PDFSettings.EXTERNAL_SYSTEM_NAME}/${PDFSettings.DIST_FOLDER}/bundle.css\" rel=\"stylesheet\" type=\"text/css\" media=\"all\">`),\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Pulls the system name from the script tags.\r\n     */\r\n    public static registerSystem() {\r\n        const scripts = $('script');\r\n        for (let i = 0; i < scripts.length; i++) {\r\n            const script = scripts.get(i) as HTMLScriptElement;\r\n            const folders = script.src.split('/');\r\n            const distIdx = folders.indexOf(PDFSettings.DIST_FOLDER);\r\n            if (distIdx === -1) continue;\r\n\r\n            if (folders[distIdx - 1] === 'pdfoundry') break;\r\n\r\n            PDFSettings.EXTERNAL_SYSTEM_NAME = folders[distIdx - 1];\r\n            break;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Register the PDF sheet and unregister invalid sheet types from it.\r\n     */\r\n    public static foundryConfig() {\r\n        Items.registerSheet(PDFSettings.INTERNAL_MODULE_NAME, PDFItemSheet, {\r\n            types: [PDFSettings.PDF_ENTITY_TYPE],\r\n            makeDefault: true,\r\n        });\r\n\r\n        // Unregister all other item sheets for the PDF entity\r\n        const pdfoundryKey = `${PDFSettings.INTERNAL_MODULE_NAME}.${PDFItemSheet.name}`;\r\n        const sheets = CONFIG.Item.sheetClasses[PDFSettings.PDF_ENTITY_TYPE];\r\n        for (const key of Object.keys(sheets)) {\r\n            const sheet = sheets[key];\r\n            // keep the PDFoundry sheet\r\n            if (sheet.id === pdfoundryKey) {\r\n                continue;\r\n            }\r\n\r\n            // id is MODULE.CLASS_NAME\r\n            const [module] = sheet.id.split('.');\r\n            Items.unregisterSheet(module, sheet.cls, {\r\n                types: [PDFSettings.PDF_ENTITY_TYPE],\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get additional context menu icons for PDF items\r\n     * @param html\r\n     * @param options\r\n     */\r\n    public static getItemContextOptions(html, options: any[]) {\r\n        const getItemFromContext = (html: JQuery<HTMLElement>): Item => {\r\n            const id = html.data('entity-id');\r\n            return game.items.get(id);\r\n        };\r\n\r\n        if (game.user.isGM) {\r\n            options.unshift({\r\n                name: game.i18n.localize('PDFOUNDRY.CONTEXT.PreloadPDF'),\r\n                icon: '<i class=\"fas fa-download fa-fw\"></i>',\r\n                condition: (entityHtml: JQuery<HTMLElement>) => {\r\n                    const item = getItemFromContext(entityHtml);\r\n                    if (item.type !== PDFSettings.PDF_ENTITY_TYPE) {\r\n                        return false;\r\n                    }\r\n\r\n                    const { url } = item.data.data;\r\n                    return url !== '';\r\n                },\r\n                callback: (entityHtml: JQuery<HTMLElement>) => {\r\n                    const item = getItemFromContext(entityHtml);\r\n                    const pdf = PDFUtil.getPDFDataFromItem(item);\r\n\r\n                    if (pdf === null) {\r\n                        //TODO: Error handling\r\n                        return;\r\n                    }\r\n\r\n                    const { url } = pdf;\r\n                    const event = new PDFPreloadEvent(null, PDFUtil.getAbsoluteURL(url));\r\n                    event.emit();\r\n\r\n                    PDFCache.preload(url);\r\n                },\r\n            });\r\n        }\r\n\r\n        options.unshift({\r\n            name: game.i18n.localize('PDFOUNDRY.CONTEXT.OpenPDF'),\r\n            icon: '<i class=\"far fa-file-pdf\"></i>',\r\n            condition: (entityHtml: JQuery<HTMLElement>) => {\r\n                const item = getItemFromContext(entityHtml);\r\n                if (item.type !== PDFSettings.PDF_ENTITY_TYPE) {\r\n                    return false;\r\n                }\r\n\r\n                const { url } = item.data.data;\r\n                return url !== '';\r\n            },\r\n            callback: (entityHtml: JQuery<HTMLElement>) => {\r\n                const item = getItemFromContext(entityHtml);\r\n                const pdf = PDFUtil.getPDFDataFromItem(item);\r\n\r\n                if (pdf === null) {\r\n                    //TODO: Error handling\r\n                    return;\r\n                }\r\n\r\n                PDFoundryAPI.openPDF(pdf, 1);\r\n            },\r\n        });\r\n    }\r\n\r\n    public static userLogin() {\r\n        let viewed;\r\n        try {\r\n            viewed = game.user.getFlag(PDFSettings.EXTERNAL_SYSTEM_NAME, PDFSettings.HELP_SEEN_KEY);\r\n        } catch (error) {\r\n            viewed = false;\r\n        } finally {\r\n            if (!viewed) {\r\n                PDFoundryAPI.showHelp();\r\n            }\r\n        }\r\n    }\r\n\r\n    public static async preCreateItem(entity, ...args) {\r\n        if (entity.type !== PDFSettings.PDF_ENTITY_TYPE) {\r\n            return;\r\n        }\r\n        entity.img = `systems/${PDFSettings.EXTERNAL_SYSTEM_NAME}/${PDFSettings.DIST_FOLDER}/assets/pdf_icon.svg`;\r\n    }\r\n\r\n    public static onRenderSettings(settings: any, html: JQuery<HTMLElement>, data: any) {\r\n        const icon = '<i class=\"far fa-file-pdf\"></i>';\r\n        const button = $(`<button>${icon} ${game.i18n.localize('PDFOUNDRY.SETTINGS.OpenHelp')}</button>`);\r\n        button.on('click', PDFoundryAPI.showHelp);\r\n\r\n        html.find('h2').last().before(button);\r\n    }\r\n}\r\n","import { PDFSettings } from '../settings/PDFSettings';\r\nimport { PDFSetViewEvent } from './events/PDFSetViewEvent';\r\nimport { PDFoundryAPI } from '../api/PDFoundryAPI';\r\nimport { PDFPreloadEvent } from './events/PDFPreloadEvent';\r\nimport { PDFCache } from '../cache/PDFCache';\r\nimport { PDFData } from '../api/types/PDFData';\r\nimport { PDFViewer } from '../viewer/PDFViewer';\r\n\r\n/**\r\n * @private\r\n */\r\nexport class PDFSocketHandler {\r\n    public static registerHandlers() {\r\n        // @ts-ignore\r\n        game.socket.on(PDFSettings.SOCKET_NAME, (event) => {\r\n            const { userIds, type, payload } = event;\r\n            // null = all users, otherwise check if this event effects us\r\n            if (userIds !== null && !userIds.includes(game.userId)) {\r\n                return;\r\n            }\r\n\r\n            if (type === PDFSetViewEvent.EVENT_TYPE) {\r\n                PDFSocketHandler.handleSetView(payload);\r\n                return;\r\n            } else if (type === PDFPreloadEvent.EVENT_TYPE) {\r\n                PDFSocketHandler.handlePreloadPDF(payload);\r\n                return;\r\n            } else {\r\n                if (type.includes('PDFOUNDRY')) {\r\n                    console.error(`Event of type ${type} has no handler.`);\r\n                    return;\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    public static handleSetView(data: any) {\r\n        if (PDFSettings.get(PDFSettings.SETTING_EXISTING_VIEWER)) {\r\n            function appIsViewer(app: Application): app is PDFViewer {\r\n                return app['pdfData'] !== undefined;\r\n            }\r\n\r\n            for (const app of Object.values(ui.windows)) {\r\n                if (!appIsViewer(app)) {\r\n                    continue;\r\n                }\r\n\r\n                const pdfData = app.pdfData;\r\n                if (data.pdfData.url === pdfData.url) {\r\n                    app.page = data.page;\r\n                    return;\r\n                }\r\n            }\r\n            // App not found, fall through.\r\n        }\r\n        PDFoundryAPI.openPDF(data.pdfData, data.page);\r\n    }\r\n\r\n    public static handlePreloadPDF(data: any) {\r\n        PDFCache.preload(data.url);\r\n    }\r\n}\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFSocketEvent } from './PDFSocketEvent';\r\n\r\n/**\r\n * @private\r\n */\r\nexport class PDFPreloadEvent extends PDFSocketEvent {\r\n    public static get EVENT_TYPE() {\r\n        return `${super.EVENT_TYPE}/PRELOAD_PDF`;\r\n    }\r\n\r\n    get type() {\r\n        return PDFPreloadEvent.EVENT_TYPE;\r\n    }\r\n\r\n    public url: string;\r\n\r\n    constructor(userIds: string[] | null, url: string) {\r\n        super(userIds);\r\n\r\n        this.url = url;\r\n    }\r\n\r\n    protected getPayload(): any {\r\n        const payload = super.getPayload();\r\n        payload.url = this.url;\r\n        return payload;\r\n    }\r\n}\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFSocketEvent } from './PDFSocketEvent';\r\nimport { PDFData } from '../../api/types/PDFData';\r\n\r\n/**\r\n * @private\r\n */\r\nexport class PDFSetViewEvent extends PDFSocketEvent {\r\n    public static get EVENT_TYPE() {\r\n        return `${super.EVENT_TYPE}/SET_VIEW`;\r\n    }\r\n\r\n    get type() {\r\n        return PDFSetViewEvent.EVENT_TYPE;\r\n    }\r\n\r\n    public page: number;\r\n    public pdfData: PDFData;\r\n\r\n    constructor(userIds: string[] | null, pdfData: PDFData, page: number) {\r\n        super(userIds);\r\n\r\n        this.pdfData = pdfData;\r\n        this.page = page;\r\n    }\r\n\r\n    protected getPayload() {\r\n        const payload = super.getPayload();\r\n        payload.pdfData = this.pdfData;\r\n        payload.page = this.page;\r\n        return payload;\r\n    }\r\n}\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFSettings } from '../../settings/PDFSettings';\r\n\r\n/**\r\n * @private\r\n */\r\nexport abstract class PDFSocketEvent {\r\n    /**\r\n     * The type of this event.\r\n     */\r\n    public static get EVENT_TYPE() {\r\n        return 'PDFOUNDRY';\r\n    }\r\n\r\n    /**\r\n     * The type of this event.\r\n     */\r\n    public abstract get type();\r\n\r\n    /**\r\n     * The user ids that should handle this event.\r\n     */\r\n    protected userIds: string[] | null;\r\n\r\n    protected constructor(userIds: string[] | null) {\r\n        this.userIds = userIds;\r\n    }\r\n\r\n    /**\r\n     * Get any data that will be sent with the event.\r\n     */\r\n    protected getPayload(): any {\r\n        return {};\r\n    }\r\n\r\n    public emit() {\r\n        // @ts-ignore\r\n        game.socket.emit(PDFSettings.SOCKET_NAME, {\r\n            type: this.type,\r\n            userIds: this.userIds,\r\n            payload: this.getPayload(),\r\n        });\r\n    }\r\n}\r\n","/* Copyright 2020 Andrew Cuccinello\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { PDFSettings } from '../settings/PDFSettings';\r\nimport { PDFEvents } from '../api/PDFEvents';\r\nimport { PDFData } from '../api/types/PDFData';\r\nimport { PDFjsViewer } from '../types/PDFjsViewer';\r\nimport { PDFSetViewEvent } from '../socket/events/PDFSetViewEvent';\r\nimport { PDFUtil } from '../api/PDFUtil';\r\nimport { PDFjsEventBus } from '../types/PDFjsEventBus';\r\nimport { PDFPlayerSelect } from '../app/PDFPlayerSelect';\r\n\r\nexport class PDFViewer extends Application {\r\n    static get defaultOptions() {\r\n        const options = super.defaultOptions;\r\n        options.classes = ['app', 'window-app', 'pdfoundry-viewer'];\r\n        options.template = `systems/${PDFSettings.EXTERNAL_SYSTEM_NAME}/pdfoundry-dist/templates/app/pdf-viewer.html`;\r\n        options.title = game.i18n.localize('PDFOUNDRY.VIEWER.ViewPDF');\r\n        options.width = 8.5 * 100 + 64;\r\n        options.height = 11 * 100 + 64;\r\n        options.resizable = true;\r\n        return options;\r\n    }\r\n\r\n    protected _frame: HTMLIFrameElement;\r\n    protected _viewer: PDFjsViewer;\r\n    protected _eventBus: PDFjsEventBus;\r\n    protected _pdfData: PDFData;\r\n\r\n    constructor(pdfData?: PDFData, options?: ApplicationOptions) {\r\n        super(options);\r\n\r\n        if (pdfData === undefined) {\r\n            pdfData = {\r\n                name: game.i18n.localize('PDFOUNDRY.VIEWER.Title'),\r\n                code: '',\r\n                offset: 0,\r\n                url: '',\r\n                cache: false,\r\n            };\r\n        }\r\n\r\n        this._pdfData = pdfData;\r\n    }\r\n\r\n    // <editor-fold desc=\"Getters & Setters\">\r\n\r\n    /**\r\n     * Returns a copy of the PDFData this viewer is using.\r\n     * Changes to this data will not reflect in the viewer.\r\n     */\r\n    public get pdfData() {\r\n        return duplicate(this._pdfData);\r\n    }\r\n\r\n    public get page() {\r\n        return this._viewer.page;\r\n    }\r\n\r\n    public set page(value: number) {\r\n        this._viewer.page = value;\r\n    }\r\n\r\n    // </editor-fold>\r\n\r\n    // <editor-fold desc=\"Foundry Overrides\">\r\n\r\n    get title(): string {\r\n        let title = this._pdfData.name;\r\n        if (this._pdfData.code !== '') {\r\n            title = `${title} (${this._pdfData.code})`;\r\n        }\r\n        return title;\r\n    }\r\n\r\n    protected _getHeaderButtons(): any[] {\r\n        const buttons = super._getHeaderButtons();\r\n        //TODO: Standardize this to function w/ the Item sheet one\r\n        buttons.unshift({\r\n            class: 'pdf-sheet-github',\r\n            icon: 'fas fa-external-link-alt',\r\n            label: 'PDFoundry',\r\n            onclick: () => window.open('https://github.com/Djphoenix719/PDFoundry', '_blank'),\r\n        });\r\n\r\n        buttons.unshift({\r\n            class: 'pdf-sheet-show-players',\r\n            icon: 'fas fa-eye',\r\n            label: game.i18n.localize('PDFOUNDRY.VIEWER.ShowToPlayersText'),\r\n            onclick: (event) => this.showTo(event),\r\n        });\r\n\r\n        return buttons;\r\n    }\r\n\r\n    getData(options?: any): any | Promise<any> {\r\n        const data = super.getData(options);\r\n        data.systemName = PDFSettings.EXTERNAL_SYSTEM_NAME;\r\n        return data;\r\n    }\r\n\r\n    protected async activateListeners(html: JQuery<HTMLElement>): Promise<void> {\r\n        super.activateListeners(html);\r\n\r\n        this._frame = html.parent().find('iframe.pdfViewer').get(0) as HTMLIFrameElement;\r\n        this.getViewer().then(async (viewer) => {\r\n            this._viewer = viewer;\r\n\r\n            this.getEventBus().then((eventBus) => {\r\n                this._eventBus = eventBus;\r\n\r\n                // const listeners = eventBus._listeners;\r\n                // for (const eventName of Object.keys(listeners)) {\r\n                //     eventBus.on(eventName, (...args) => {\r\n                //         this.logEvent(eventName, args);\r\n                //     });\r\n                // }\r\n\r\n                // Fire the viewerReady event so the viewer may be used externally\r\n                PDFEvents.fire('viewerReady', this);\r\n            });\r\n        });\r\n\r\n        // _getHeaderButtons does not permit titles...\r\n        $(html).parents().parents().find('.pdf-sheet-show-players').prop('title', game.i18n.localize('PDFOUNDRY.VIEWER.ShowToPlayersTitle'));\r\n    }\r\n\r\n    // private logEvent(key: string, ...args) {\r\n    //     console.debug(key);\r\n    //     console.debug(args);\r\n    // }\r\n\r\n    async close(): Promise<any> {\r\n        PDFEvents.fire('viewerClose', this);\r\n        return super.close();\r\n    }\r\n\r\n    // </editor-fold>\r\n\r\n    /**\r\n     * Show the current page to GMs.\r\n     */\r\n    private showTo(event: MouseEvent) {\r\n        const pdfData = this.pdfData;\r\n        pdfData.offset = 0;\r\n\r\n        // @ts-ignore\r\n        const ids = PDFUtil.getUserIdsExceptMe();\r\n        if (event.shiftKey) {\r\n            new PDFSetViewEvent(ids, pdfData, this.page).emit();\r\n        } else {\r\n            new PDFPlayerSelect(ids, (filteredIds) => {\r\n                new PDFSetViewEvent(filteredIds, pdfData, this.page).emit();\r\n            }).render(true);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Wait for the internal PDFjs viewer to be ready and usable.\r\n     */\r\n    private getViewer(): Promise<PDFjsViewer> {\r\n        if (this._viewer) {\r\n            return Promise.resolve(this._viewer);\r\n        }\r\n\r\n        return new Promise<any>((resolve, reject) => {\r\n            let timeout;\r\n            const returnOrWait = () => {\r\n                // If our window has finished initializing...\r\n                if (this._frame) {\r\n                    // If PDFjs has finished initializing...\r\n                    if (this._frame.contentWindow && this._frame.contentWindow['PDFViewerApplication']) {\r\n                        const viewer = this._frame.contentWindow['PDFViewerApplication'];\r\n                        resolve(viewer);\r\n                        return;\r\n                    }\r\n                }\r\n\r\n                // If any ifs fall through, try again in a few ms\r\n                timeout = setTimeout(returnOrWait, 5);\r\n            };\r\n            returnOrWait();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Wait for the internal PDFjs eventBus to be ready and usable.\r\n     */\r\n    private getEventBus(): Promise<PDFjsEventBus> {\r\n        if (this._eventBus) {\r\n            return Promise.resolve(this._eventBus);\r\n        }\r\n\r\n        return new Promise<any>((resolve, reject) => {\r\n            this.getViewer().then((viewer) => {\r\n                let timeout;\r\n                const returnOrWait = () => {\r\n                    if (viewer.eventBus) {\r\n                        resolve(viewer.eventBus);\r\n                        return;\r\n                    }\r\n                    timeout = setTimeout(returnOrWait, 5);\r\n                };\r\n                returnOrWait();\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Finish the download and return the byte array for the file.\r\n     */\r\n    public download(): Promise<Uint8Array> {\r\n        return new Promise<Uint8Array>(async (resolve, reject) => {\r\n            const viewer = await this.getViewer();\r\n            let timeout;\r\n            const returnOrWait = () => {\r\n                if (viewer.downloadComplete) {\r\n                    resolve(viewer.pdfDocument.getData());\r\n                    return;\r\n                }\r\n\r\n                timeout = setTimeout(returnOrWait, 50);\r\n            };\r\n            returnOrWait();\r\n        });\r\n    }\r\n\r\n    public async open(pdfSource: string | Uint8Array, page?: number) {\r\n        const pdfjsViewer = await this.getViewer();\r\n\r\n        if (page) {\r\n            pdfjsViewer.initialBookmark = `page=${page}`;\r\n        }\r\n\r\n        await pdfjsViewer.open(pdfSource);\r\n    }\r\n}\r\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvbW9kdWxlL2FwaS9QREZFdmVudHMudHMiLCJzcmMvbW9kdWxlL2FwaS9QREZVdGlsLnRzIiwic3JjL21vZHVsZS9hcGkvUERGb3VuZHJ5QVBJLnRzIiwic3JjL21vZHVsZS9hcHAvUERGSXRlbVNoZWV0LnRzIiwic3JjL21vZHVsZS9hcHAvUERGUGxheWVyU2VsZWN0LnRzIiwic3JjL21vZHVsZS9jYWNoZS9QREZDYWNoZS50cyIsInNyYy9tb2R1bGUvbWFpbi50cyIsInNyYy9tb2R1bGUvc2V0dGluZ3MvUERGSTE4bi50cyIsInNyYy9tb2R1bGUvc2V0dGluZ3MvUERGU2V0dGluZ3MudHMiLCJzcmMvbW9kdWxlL3NldHVwL1BERlNldHVwLnRzIiwic3JjL21vZHVsZS9zb2NrZXQvUERGU29ja2V0SGFuZGxlci50cyIsInNyYy9tb2R1bGUvc29ja2V0L2V2ZW50cy9QREZQcmVsb2FkRXZlbnQudHMiLCJzcmMvbW9kdWxlL3NvY2tldC9ldmVudHMvUERGU2V0Vmlld0V2ZW50LnRzIiwic3JjL21vZHVsZS9zb2NrZXQvZXZlbnRzL1BERlNvY2tldEV2ZW50LnRzIiwic3JjL21vZHVsZS92aWV3ZXIvUERGVmlld2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOztBQ0FBOzs7Ozs7Ozs7Ozs7O0dBYUc7OztBQUlIOztHQUVHO0FBQ0gsTUFBTSxVQUFVO0lBSVosWUFBWSxJQUFjO1FBQ3RCLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDO1FBQ2xCLElBQUksQ0FBQyxVQUFVLEdBQUcsRUFBRSxDQUFDO0lBQ3pCLENBQUM7SUFFRDs7O09BR0c7SUFDSSxFQUFFLENBQUMsUUFBa0I7UUFDeEIsSUFBSSxJQUFJLENBQUMsVUFBVSxLQUFLLFNBQVMsRUFBRTtZQUMvQixPQUFPO1NBQ1Y7UUFFRCxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcs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O1lBRTNDLElBQUksSUFBSSxFQUFFO2dCQUNOLFdBQVcsQ0FBQyxlQUFlLEdBQUcsUUFBUSxJQUFJLEVBQUUsQ0FBQzthQUNoRDtZQUVELE1BQU0sV0FBVyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUN0QyxDQUFDO0tBQUE7Q0FDSjtBQWhPRCw4QkFnT0MiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCIvKiBDb3B5cmlnaHQgMjAyMCBBbmRyZXcgQ3VjY2luZWxsb1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcblxyXG5pbXBvcnQgeyBQREZFdmVudCwgQ2FsbGJhY2tTZXR1cCwgQ2FsbGJhY2tWaWV3ZXIsIENhbGxiYWNrUGFnZVJlbmRlcmVkLCBDYWxsYmFja1BhZ2VDaGFuZ2luZyB9IGZyb20gJy4vdHlwZXMvRXZlbnRIb29rcyc7XHJcblxyXG4vKipcclxuICogQHByaXZhdGVcclxuICovXHJcbmNsYXNzIEV2ZW50U3RvcmUge1xyXG4gICAgcHJpdmF0ZSByZWFkb25seSBfbmFtZTogUERGRXZlbnQ7XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IF9jYWxsYmFja3M6IEZ1bmN0aW9uW107XHJcblxyXG4gICAgY29uc3RydWN0b3IobmFtZTogUERGRXZlbnQpIHtcclxuICAgICAgICB0aGlzLl9uYW1lID0gbmFtZTtcclxuICAgICAgICB0aGlzLl9jYWxsYmFja3MgPSBbXTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFR1cm4gb24gYW4gZXZlbnQgY2FsbGJhY2sgZm9yIHRoaXMgZXZlbnQuXHJcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2sgVGhlIGNhbGxiYWNrIHRvIHR1cm4gb25cclxuICAgICAqL1xyXG4gICAgcHVibGljIG9uKGNhbGxiYWNrOiBGdW5jdGlvbikge1xyXG4gICAgICAgIGlmICh0aGlzLl9jYWxsYmFja3MgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuX2NhbGxiYWNrcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fY2FsbGJhY2tzW2ldID09PSBjYWxsYmFjaykgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fY2FsbGJhY2tzLnB1c2goY2FsbGJhY2spO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVHVybiBvZmYgYW4gZXZlbnQgY2FsbGJhY2sgZm9yIHRoaXMgZXZlbnQuXHJcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2sgVGhlIGNhbGxiYWNrIHRvIHR1cm4gb2ZmXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBvZmYoY2FsbGJhY2s6IEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2NhbGxiYWNrcyA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAobGV0IGkgPSB0aGlzLl9jYWxsYmFja3MubGVuZ3RoOyBpID49IDA7IGktLSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fY2FsbGJhY2tzW2ldID09PSBjYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2FsbGJhY2tzLnNwbGljZShpLCAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEZpcmUgYW4gZXZlbnQgYW5kIGZvcndhcmQgdGhlIGFyZ3MgdG8gYWxsIGhhbmRsZXJzXHJcbiAgICAgKiBAcGFyYW0gYXJncyBBbnkgYXJndW1lbnRzIHRoYXQgc2hvdWxkIGJlIHBhc3NlZCB0byBoYW5kbGVyc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZmlyZSguLi5hcmdzKSB7XHJcbiAgICAgICAgaWYgKFBERkV2ZW50cy5ERUJVRykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKGA8JHt0aGlzLl9uYW1lfT5gKTtcclxuICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhhcmdzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgY2Igb2YgdGhpcy5fY2FsbGJhY2tzKSB7XHJcbiAgICAgICAgICAgIGNiKC4uLmFyZ3MpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFRyYWNrcyBhbmQgcHVibGlzaGVzIGV2ZW50cyBmb3IgUERGIHJlbGF0ZWQgb2NjdXJyZW5jZXMuIFRoaXMgY2xhc3MgaXMgY2FsbGFibGUgdGhyb3VnaCBgdWkuUERGb3VuZHJ5LmV2ZW50c2AuXHJcbiAqIEFsbCBldmVudCBwcm9wZXJ0aWVzIG9mIHRoaXMgY2xhc3MgYXJlIGFjY2Vzc2libGUgd2l0aCB0aGUgYG9uYCBtZXRob2Qgb3IgdmlhIGhlbHBlciBtZXRob2RzIHdoaWNoIGNvbnRhaW4gYWRkaXRpb25hbFxyXG4gKiB0eXBlIGhpbnRpbmcuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUERGRXZlbnRzIHtcclxuICAgIC8qKlxyXG4gICAgICogSWYgc2V0IHRvIHRydWUsIGV2ZXJ5IGV2ZW50IGNhbGwgd2lsbCBiZSBsb2dnZWQuIEZ1bmN0aW9ucyBtdWNoIGluIHRoZSBzYW1lIG1hbm5lciB0aGF0IGBDT05GSUcuZGVidWcuaG9va3NgIGRvZXMuXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgREVCVUc6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgICBwcml2YXRlIHN0YXRpYyBfRVZFTlRTID0ge1xyXG4gICAgICAgIGluaXQ6IG5ldyBFdmVudFN0b3JlKCdpbml0JyksXHJcbiAgICAgICAgc2V0dXA6IG5ldyBFdmVudFN0b3JlKCdzZXR1cCcpLFxyXG4gICAgICAgIHJlYWR5OiBuZXcgRXZlbnRTdG9yZSgncmVhZHknKSxcclxuXHJcbiAgICAgICAgdmlld2VyT3BlbjogbmV3IEV2ZW50U3RvcmUoJ3ZpZXdlck9wZW4nKSxcclxuICAgICAgICB2aWV3ZXJDbG9zZTogbmV3IEV2ZW50U3RvcmUoJ3ZpZXdlckNsb3NlJyksXHJcbiAgICAgICAgdmlld2VyUmVhZHk6IG5ldyBFdmVudFN0b3JlKCd2aWV3ZXJSZWFkeScpLFxyXG5cclxuICAgICAgICB2aWV3ZXJQYWdlUmVuZGVyZWQ6IG5ldyBFdmVudFN0b3JlKCd2aWV3ZXJQYWdlUmVuZGVyZWQnKSxcclxuICAgIH07XHJcblxyXG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJTZXR1cCAmIEluaXRpYWxpemF0aW9uIEV2ZW50c1wiPlxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2FsbGVkIHdoZW4gYWxsIFBERm91bmRyeSBpbml0IHN0YWdlIHRhc2tzIGFyZSBkb25lLlxyXG4gICAgICogQHBhcmFtIGNiXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgaW5pdChjYjogQ2FsbGJhY2tTZXR1cCkge1xyXG4gICAgICAgIHJldHVybiBQREZFdmVudHMuX0VWRU5UU1snaW5pdCddLm9uKGNiKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENhbGxlZCB3aGVuIGFsbCBQREZvdW5kcnkgc2V0dXAgc3RhZ2UgdGFza3MgYXJlIGRvbmUuXHJcbiAgICAgKiBAcGFyYW0gY2JcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBzZXR1cChjYjogQ2FsbGJhY2tTZXR1cCkge1xyXG4gICAgICAgIHJldHVybiBQREZFdmVudHMuX0VWRU5UU1snc2V0dXAnXS5vbihjYik7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDYWxsZWQgd2hlbiBhbGwgUERGb3VuZHJ5IHJlYWR5IHN0YWdlIHRhc2tzIGFyZSBkb25lLlxyXG4gICAgICogQHBhcmFtIGNiXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgcmVhZHkoY2I6IENhbGxiYWNrU2V0dXApIHtcclxuICAgICAgICByZXR1cm4gUERGRXZlbnRzLl9FVkVOVFNbJ3JlYWR5J10ub24oY2IpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIDwvZWRpdG9yLWZvbGQ+XHJcblxyXG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJWaWV3ZXIgRXZlbnRzXCI+XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDYWxsZWQgd2hlbiBhIFBERiB2aWV3ZXIgYmVnaW5zIG9wZW5pbmdcclxuICAgICAqIEBwYXJhbSBjYlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIHZpZXdlck9wZW4oY2I6IENhbGxiYWNrVmlld2VyKSB7XHJcbiAgICAgICAgcmV0dXJuIFBERkV2ZW50cy5fRVZFTlRTWyd2aWV3ZXJPcGVuJ10ub24oY2IpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2FsbGVkIHdoZW4gYSBQREYgdmlld2VyIGJlZ2lucyBjbG9zaW5nXHJcbiAgICAgKiBAcGFyYW0gY2JcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyB2aWV3ZXJDbG9zZShjYjogQ2FsbGJhY2tWaWV3ZXIpIHtcclxuICAgICAgICByZXR1cm4gUERGRXZlbnRzLl9FVkVOVFNbJ3ZpZXdlckNsb3NlJ10ub24oY2IpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2FsbGVkIHdoZW4gYSBQREYgdmlld2VyIGlzIHJlYWR5IHRvIHVzZVxyXG4gICAgICogQHBhcmFtIGNiXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgdmlld2VyUmVhZHkoY2I6IENhbGxiYWNrVmlld2VyKSB7XHJcbiAgICAgICAgcmV0dXJuIFBERkV2ZW50cy5fRVZFTlRTWyd2aWV3ZXJSZWFkeSddLm9uKGNiKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENhbGxlZCB3aGVuIGEgbmV3IHBhZ2UgaGFzIGZpbmlzaGVkIHJlbmRlcmluZy4gVGhlIGlubmVyIEhUTUwgb2YgdGhlIGRpdiBwcm92aWRlZCBieSB0aGlzIGV2ZW50IHdpbGxcclxuICAgICAqIGJlIHJlcGxhY2VkIGlmIHRoZSB1c2VyIHNjcm9sbHMgdGhlIHBhZ2Ugb3V0IG9mIHZpZXcuXHJcbiAgICAgKiBAcGFyYW0gY2JcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyB2aWV3ZXJQYWdlUmVuZGVyZWQoY2I6IENhbGxiYWNrUGFnZVJlbmRlcmVkKSB7XHJcbiAgICAgICAgcmV0dXJuIFBERkV2ZW50cy5fRVZFTlRTWyd2aWV3ZXJQYWdlUmVuZGVyZWQnXS5vbihjYik7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDYWxsZWQgd2hlbiB0aGUgcGFnZSBpcyBjaGFuZ2VkLlxyXG4gICAgICogQHBhcmFtIGNiXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgdmlld2VyUGFnZUNoYW5naW5nKGNiOiBDYWxsYmFja1BhZ2VDaGFuZ2luZykge1xyXG4gICAgICAgIHJldHVybiBQREZFdmVudHMuX0VWRU5UU1sndmlld2VyUGFnZUNoYW5naW5nJ10ub24oY2IpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIDwvZWRpdG9yLWZvbGQ+XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBMaWtlIHtAbGluayBQREZFdmVudHMub259IGJ1dCBmaXJlcyB0aGUgZXZlbnQgb25seSBvbmNlLCB0aGVuIGNhbGxzIG9mZi4gU2VlIGluZGl2aWR1YWwgZXZlbnRzIGZvciBjYWxsYmFja1xyXG4gICAgICogZnVuY3Rpb24gcGFyYW1ldGVycy5cclxuICAgICAqIEBwYXJhbSBldmVudFxyXG4gICAgICogQHBhcmFtIGNhbGxiYWNrXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgb25jZShldmVudDogUERGRXZlbnQsIGNhbGxiYWNrOiBGdW5jdGlvbikge1xyXG4gICAgICAgIGNvbnN0IHdyYXBwZXIgPSBmdW5jdGlvbiAoLi4uYXJncykge1xyXG4gICAgICAgICAgICBjYWxsYmFjayhhcmdzKTtcclxuICAgICAgICAgICAgUERGRXZlbnRzLm9mZihldmVudCwgd3JhcHBlcik7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBQREZFdmVudHMub24oZXZlbnQsIHdyYXBwZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVHVybiBvbiBhbiBldmVudCBjYWxsYmFjayBmb3IgYW4gZXZlbnQuXHJcbiAgICAgKiBAcGFyYW0gZXZlbnQgVGhlIG5hbWUgb2YgdGhlIGV2ZW50XHJcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2sgVGhlIGNhbGxiYWNrIHRvIHR1cm4gb25cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBvbihldmVudDogUERGRXZlbnQsIGNhbGxiYWNrOiBGdW5jdGlvbikge1xyXG4gICAgICAgIFBERkV2ZW50cy5fRVZFTlRTW2V2ZW50XS5vbihjYWxsYmFjayk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUdXJuIG9mZiBhbiBldmVudCBjYWxsYmFjayBmb3IgYW4gZXZlbnQuXHJcbiAgICAgKiBAcGFyYW0gZXZlbnQgVGhlIG5hbWUgb2YgdGhlIGV2ZW50XHJcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2sgVGhlIGNhbGxiYWNrIHRvIHR1cm4gb2ZmXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgb2ZmKGV2ZW50OiBQREZFdmVudCwgY2FsbGJhY2s6IEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgUERGRXZlbnRzLl9FVkVOVFNbZXZlbnRdLm9mZihjYWxsYmFjayk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBmaXJlKGV2ZW50OiBQREZFdmVudCwgLi4uYXJncykge1xyXG4gICAgICAgIGlmIChQREZFdmVudHMuREVCVUcpIHtcclxuICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhgRmlyaW5nIEV2ZW50OiAke2V2ZW50fWApO1xyXG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKGFyZ3MpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBQREZFdmVudHMuX0VWRU5UU1tldmVudF0uZmlyZShhcmdzKTtcclxuICAgIH1cclxufVxyXG4iLCIvKiBDb3B5cmlnaHQgMjAyMCBBbmRyZXcgQ3VjY2luZWxsb1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcblxyXG5pbXBvcnQgeyBQREZEYXRhIH0gZnJvbSAnLi90eXBlcy9QREZEYXRhJztcclxuXHJcbi8qKlxyXG4gKiBDb250YWlucyB2YXJpb3VzIHV0aWxpdHkgZnVuY3Rpb25zIGZvciBjb21tb24gb3BlcmF0aW9ucy5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBQREZVdGlsIHtcclxuICAgIC8qKlxyXG4gICAgICogSGVscGVyIG1ldGhvZC4gQ29udmVydCBhIHJlbGF0aXZlIFVSTCB0byBhIGFic29sdXRlIFVSTFxyXG4gICAgICogIGJ5IHByZXBlbmRpbmcgdGhlIHdpbmRvdyBvcmlnaW4gdG8gdGhlIHJlbGF0aXZlIFVSTC5cclxuICAgICAqIEBwYXJhbSBkYXRhVXJsXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0QWJzb2x1dGVVUkwoZGF0YVVybDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gYCR7d2luZG93Lm9yaWdpbn0vJHtkYXRhVXJsfWA7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQdWxsIHJlbGV2YW50IGRhdGEgZnJvbSBhbiBpdGVtLCBjcmVhdGluZyBhIHtAbGluayBQREZEYXRhfS5cclxuICAgICAqIEBwYXJhbSBpdGVtIFRoZSBpdGVtIHRvIHB1bGwgZGF0YSBmcm9tLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGdldFBERkRhdGFGcm9tSXRlbShpdGVtOiBJdGVtKTogUERGRGF0YSB8IG51bGwge1xyXG4gICAgICAgIGlmIChpdGVtID09PSB1bmRlZmluZWQgfHwgaXRlbSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCB7IGNvZGUsIHVybCwgb2Zmc2V0LCBjYWNoZSB9ID0gaXRlbS5kYXRhLmRhdGE7XHJcbiAgICAgICAgbGV0IG5hbWUgPSBpdGVtLm5hbWU7XHJcblxyXG4gICAgICAgIGlmICh0eXBlb2Ygb2Zmc2V0ID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBvZmZzZXQgPSBwYXJzZUludChvZmZzZXQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgY29kZSxcclxuICAgICAgICAgICAgdXJsLFxyXG4gICAgICAgICAgICBvZmZzZXQsXHJcbiAgICAgICAgICAgIGNhY2hlLFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIFVSTCBzdGFydHMgd2l0aCB0aGUgb3JpZ2luLlxyXG4gICAgICogQHBhcmFtIGRhdGFVcmwgQSB1cmwuXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgdmFsaWRhdGVBYnNvbHV0ZVVSTChkYXRhVXJsOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gZGF0YVVybC5zdGFydHNXaXRoKHdpbmRvdy5vcmlnaW4pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJuIGFsbCB1c2VycyBpZHMgZXhjZXB0IHRoZSBhY3RpdmUgdXNlclxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGdldFVzZXJJZHNFeGNlcHRNZSgpIHtcclxuICAgICAgICByZXR1cm4gZ2FtZS51c2Vyc1xyXG4gICAgICAgICAgICAuZmlsdGVyKCh1c2VyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdXNlci5pZCAhPT0gZ2FtZS51c2VySWQ7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5tYXAoKHVzZXIpID0+IHVzZXIuaWQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0cyB1c2VycyB3aXRoIGEgcm9sZSBudW1iZXIgYmV0d2VlbiB0aGUgcHJvdmlkZWQgbG93ZXIgaW5jbHVzaXZlIGFuZCB1cHBlciBpbmNsdXNpdmUgYm91bmRzLlxyXG4gICAgICogQHBhcmFtIGxvd2VyXHJcbiAgICAgKiBAcGFyYW0gdXBwZXJcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXRVc2VySWRzQmV0d2VlblJvbGVzKGxvd2VyOiBudW1iZXIsIHVwcGVyOiBudW1iZXIpIHtcclxuICAgICAgICByZXR1cm4gZ2FtZS51c2Vyc1xyXG4gICAgICAgICAgICAuZmlsdGVyKCh1c2VyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdXNlci5yb2xlID49IGxvd2VyICYmIHVzZXIucm9sZSA8PSB1cHBlcjtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLm1hcCgodXNlcikgPT4gdXNlci5pZCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXRzIHVzZXJzIHdpdGggYSByb2xlIG51bWJlciBleGFjdGx5IG1hdGNoaW5nIHRoZSBvbmUgcHJvdmlkZWQuXHJcbiAgICAgKiBAcGFyYW0gcm9sZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGdldFVzZXJJZHNPZlJvbGUocm9sZTogbnVtYmVyKSB7XHJcbiAgICAgICAgcmV0dXJuIGdhbWUudXNlcnNcclxuICAgICAgICAgICAgLmZpbHRlcigodXNlcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVzZXIucm9sZSA9PT0gcm9sZTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLm1hcCgodXNlcikgPT4gdXNlci5pZCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXRzIHVzZXJzIHdpdGggYSByb2xlIG51bWJlciBhdCBsZWFzdCB0aGUgb25lIHByb3ZpZGVkLlxyXG4gICAgICogQHBhcmFtIHJvbGVcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXRVc2VySWRzQXRMZWFzdFJvbGUocm9sZTogbnVtYmVyKSB7XHJcbiAgICAgICAgcmV0dXJuIGdhbWUudXNlcnNcclxuICAgICAgICAgICAgLmZpbHRlcigodXNlcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVzZXIucm9sZSA+PSByb2xlO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAubWFwKCh1c2VyKSA9PiB1c2VyLmlkKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldHMgdXNlcnMgd2l0aCBhIHJvbGUgbnVtYmVyIGF0IG1vc3QgdGhlIG9uZSBwcm92aWRlZC5cclxuICAgICAqIEBwYXJhbSByb2xlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0VXNlcklkc0F0TW9zdFJvbGUocm9sZTogbnVtYmVyKSB7XHJcbiAgICAgICAgcmV0dXJuIGdhbWUudXNlcnNcclxuICAgICAgICAgICAgLmZpbHRlcigodXNlcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVzZXIucm9sZSA8PSByb2xlO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAubWFwKCh1c2VyKSA9PiB1c2VyLmlkKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENoZWNrcyBpZiBhIHJlbW90ZSBmaWxlIGV4aXN0cyBhdCB0aGUgc3BlY2lmaWVkIHBhdGguIFRoYXQgaXMsIGlmIHRoZSBVUkwgaXMgdmFsaWQuIFRoaXMgZG9lcyBub3QgZ3VhcmFudGVlIGFcclxuICAgICAqIHZhbGlkIGZpbGUgZXhpc3RzIGF0IHRoYXQgbG9jYXRpb24uIEZvciBleGFtcGxlLCBhbiBIVE1MIGZpbGUgd2lsbCByZXN1bHQgaW4gdHJ1ZSBidXQgbm90IGJlIGEgdmFsaWQgUERGLlxyXG4gICAgICogQHBhcmFtIHBhdGhcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBmaWxlRXhpc3RzKHBhdGg6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZTxib29sZWFuPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgICAgICB1cmw6IHBhdGgsXHJcbiAgICAgICAgICAgICAgICB0eXBlOiAnSEVBRCcsXHJcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuIiwiLyogQ29weXJpZ2h0IDIwMjAgQW5kcmV3IEN1Y2NpbmVsbG9cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgUERGU2V0dGluZ3MgfSBmcm9tICcuLi9zZXR0aW5ncy9QREZTZXR0aW5ncyc7XHJcbmltcG9ydCB7IFBERlZpZXdlciB9IGZyb20gJy4uL3ZpZXdlci9QREZWaWV3ZXInO1xyXG5pbXBvcnQgeyBQREZDYWNoZSB9IGZyb20gJy4uL2NhY2hlL1BERkNhY2hlJztcclxuaW1wb3J0IHsgUERGRXZlbnRzIH0gZnJvbSAnLi9QREZFdmVudHMnO1xyXG5pbXBvcnQgeyBQREZVdGlsIH0gZnJvbSAnLi9QREZVdGlsJztcclxuaW1wb3J0IHsgUERGRGF0YSB9IGZyb20gJy4vdHlwZXMvUERGRGF0YSc7XHJcblxyXG50eXBlIEl0ZW1Db21wYXJlciA9IChpdGVtOiBJdGVtKSA9PiBib29sZWFuO1xyXG5cclxuYXN5bmMgZnVuY3Rpb24gX2hhbmRsZU9wZW4odmlld2VyOiBQREZWaWV3ZXIsIHVybDogc3RyaW5nLCBwYWdlOiBudW1iZXIsIGNhY2hlOiBib29sZWFuKSB7XHJcbiAgICBpZiAoY2FjaGUpIHtcclxuICAgICAgICBjb25zdCBjYWNoZWRCeXRlcyA9IGF3YWl0IFBERkNhY2hlLmdldENhY2hlKHVybCk7XHJcbiAgICAgICAgLy8gSWYgd2UgaGF2ZSBhIGNhY2hlIGhpdCBvcGVuIHRoZSBjYWNoZWQgZGF0YVxyXG4gICAgICAgIGlmIChjYWNoZWRCeXRlcykge1xyXG4gICAgICAgICAgICBhd2FpdCB2aWV3ZXIub3BlbihjYWNoZWRCeXRlcywgcGFnZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gT3RoZXJ3aXNlIHdlIHNob3VsZCBvcGVuIGl0IGJ5IHVybFxyXG4gICAgICAgICAgICBhd2FpdCB2aWV3ZXIub3Blbih1cmwsIHBhZ2UpO1xyXG4gICAgICAgICAgICAvLyBBbmQgd2hlbiB0aGUgZG93bmxvYWQgaXMgY29tcGxldGUgc2V0IHRoZSBjYWNoZVxyXG4gICAgICAgICAgICB2aWV3ZXIuZG93bmxvYWQoKS50aGVuKChieXRlcykgPT4ge1xyXG4gICAgICAgICAgICAgICAgUERGQ2FjaGUuc2V0Q2FjaGUodXJsLCBieXRlcyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYXdhaXQgdmlld2VyLm9wZW4odXJsLCBwYWdlKTtcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFRoZSBQREZvdW5kcnkgQVBJIDxicj5cclxuICpcclxuICogWW91IGNhbiBhY2Nlc3MgdGhlIEFQSSB3aXRoIGB1aS5QREZvdW5kcnlgLiBOb3RlIHRoZSBwcmltYXJ5IHdheSB0byBvYnNlcnZlIGJlaGF2aW9yIG9mIHRoZSBQREYgdmlld2VyIGlzIHRvIHVzZVxyXG4gKiB0aGUgcHJvdmlkZWQge0BsaW5rIFBERkV2ZW50c30gY2xhc3MuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUERGb3VuZHJ5QVBJIHtcclxuICAgIC8qKlxyXG4gICAgICogQSByZWZlcmVuY2UgdG8gdGhlIHN0YXRpYyB7QGxpbmsgUERGRXZlbnRzfSBjbGFzcy5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXQgZXZlbnRzKCkge1xyXG4gICAgICAgIHJldHVybiBQREZFdmVudHM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBIHJlZmVyZW5jZSB0byB0aGUgc3RhdGljIHtAbGluayBQREZVdGlsfSBjbGFzcy5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXQgdXRpbCgpIHtcclxuICAgICAgICByZXR1cm4gUERGVXRpbDtcclxuICAgIH1cclxuXHJcbiAgICAvLyA8ZWRpdG9yLWZvbGQgZGVzYz1cIkdldFBERkRhdGEgTWV0aG9kc1wiPlxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSGVscGVyIG1ldGhvZC4gQWxpYXMgZm9yIHtAbGluayBQREZvdW5kcnlBUEkuZ2V0UERGRGF0YX0gd2l0aCBhXHJcbiAgICAgKiAgY29tcGFyZXIgdGhhdCBzZWFyY2hlcyBieSBQREYgQ29kZS5cclxuICAgICAqIEBwYXJhbSBjb2RlIFdoaWNoIGNvZGUgdG8gc2VhcmNoIGZvciBhIFBERiB3aXRoLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGdldFBERkRhdGFCeUNvZGUoY29kZTogc3RyaW5nKTogUERGRGF0YSB8IG51bGwge1xyXG4gICAgICAgIHJldHVybiBQREZvdW5kcnlBUEkuZ2V0UERGRGF0YSgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gaXRlbS5kYXRhLmRhdGEuY29kZSA9PT0gY29kZTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEhlbHBlciBtZXRob2QuIEFsaWFzIGZvciB7QGxpbmsgUERGb3VuZHJ5QVBJLmdldFBERkRhdGF9IHdpdGggYVxyXG4gICAgICogIGNvbXBhcmVyIHRoYXQgc2VhcmNoZXMgYnkgUERGIE5hbWUuXHJcbiAgICAgKiBAcGFyYW0gbmFtZSBXaGljaCBuYW1lIHRvIHNlYXJjaCBmb3IgYSBQREYgd2l0aC5cclxuICAgICAqIEBwYXJhbSBjYXNlSW5zZW5zaXRpdmUgSWYgYSBjYXNlIGluc2Vuc2l0aXZlIHNlYXJjaCBzaG91bGQgYmUgZG9uZS5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXRQREZEYXRhQnlOYW1lKG5hbWU6IHN0cmluZywgY2FzZUluc2Vuc2l0aXZlOiBib29sZWFuID0gdHJ1ZSk6IFBERkRhdGEgfCBudWxsIHtcclxuICAgICAgICBpZiAoY2FzZUluc2Vuc2l0aXZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQREZvdW5kcnlBUEkuZ2V0UERGRGF0YSgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0ubmFtZS50b0xvd2VyQ2FzZSgpID09PSBuYW1lLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQREZvdW5kcnlBUEkuZ2V0UERGRGF0YSgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0ubmFtZSA9PT0gbmFtZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRmluZHMgYSBQREYgZW50aXR5IGNyZWF0ZWQgYnkgdGhlIHVzZXIgYW5kIGNvbnN0cnVjdHMgYVxyXG4gICAgICogIHtAbGluayBQREZEYXRhfSBvYmplY3Qgb2YgdGhlIHJlc3VsdGluZyBQREYncyBkYXRhLlxyXG4gICAgICogQHBhcmFtIGNvbXBhcmVyIEEgY29tcGFyaXNvbiBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgdXNlZC5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXRQREZEYXRhKGNvbXBhcmVyOiBJdGVtQ29tcGFyZXIpOiBQREZEYXRhIHwgbnVsbCB7XHJcbiAgICAgICAgY29uc3QgcGRmOiBJdGVtID0gZ2FtZS5pdGVtcy5maW5kKChpdGVtOiBJdGVtKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiBpdGVtLnR5cGUgPT09IFBERlNldHRpbmdzLlBERl9FTlRJVFlfVFlQRSAmJiBjb21wYXJlcihpdGVtKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIFBERlV0aWwuZ2V0UERGRGF0YUZyb21JdGVtKHBkZik7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cclxuXHJcbiAgICAvLyA8ZWRpdG9yLWZvbGQgZGVzYz1cIk9wZW5QREYgTWV0aG9kc1wiPlxyXG5cclxuICAgIC8qKlxyXG4gICAgICogT3BlbiB0aGUgUERGIHdpdGggdGhlIHByb3ZpZGVkIGNvZGUgdG8gdGhlIHNwZWNpZmllZCBwYWdlLlxyXG4gICAgICogSGVscGVyIGZvciB7QGxpbmsgZ2V0UERGRGF0YUJ5Q29kZX0gdGhlbiB7QGxpbmsgb3BlblBERn0uXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgYXN5bmMgb3BlblBERkJ5Q29kZShjb2RlOiBzdHJpbmcsIHBhZ2U6IG51bWJlciA9IDEpIHtcclxuICAgICAgICBjb25zdCBwZGYgPSB0aGlzLmdldFBERkRhdGFCeUNvZGUoY29kZSk7XHJcblxyXG4gICAgICAgIGlmIChwZGYgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgY29uc3QgZXJyb3IgPSBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5FUlJPUi5Ob1BERldpdGhDb2RlJyk7XHJcblxyXG4gICAgICAgICAgICBpZiAoUERGU2V0dGluZ3MuTk9USUZJQ0FUSU9OUykge1xyXG4gICAgICAgICAgICAgICAgdWkubm90aWZpY2F0aW9ucy5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5vcGVuUERGKHBkZiwgcGFnZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBPcGVuIHRoZSBQREYgd2l0aCB0aGUgcHJvdmlkZWQgY29kZSB0byB0aGUgc3BlY2lmaWVkIHBhZ2UuXHJcbiAgICAgKiBIZWxwZXIgZm9yIHtAbGluayBnZXRQREZEYXRhQnlDb2RlfSB0aGVuIHtAbGluayBvcGVuUERGfS5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBvcGVuUERGQnlOYW1lKG5hbWU6IHN0cmluZywgcGFnZTogbnVtYmVyID0gMSkge1xyXG4gICAgICAgIGNvbnN0IHBkZiA9IHRoaXMuZ2V0UERGRGF0YUJ5TmFtZShuYW1lKTtcclxuXHJcbiAgICAgICAgaWYgKHBkZiA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlID0gZ2FtZS5pMThuLmxvY2FsaXplKCdQREZPVU5EUlkuRVJST1IuTm9QREZXaXRoTmFtZScpO1xyXG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcihtZXNzYWdlKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChQREZTZXR0aW5ncy5OT1RJRklDQVRJT05TKSB7XHJcbiAgICAgICAgICAgICAgICB1aS5ub3RpZmljYXRpb25zLmVycm9yKGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMub3BlblBERihwZGYsIHBhZ2UpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogT3BlbiB0aGUgcHJvdmlkZWQge0BsaW5rIFBERkRhdGF9IHRvIHRoZSBzcGVjaWZpZWQgcGFnZS5cclxuICAgICAqIEBwYXJhbSBwZGYgVGhlIFBERiB0byBvcGVuLiBTZWUge0BsaW5rIFBERm91bmRyeUFQSS5nZXRQREZEYXRhfS5cclxuICAgICAqIEBwYXJhbSBwYWdlIFRoZSBwYWdlIHRvIG9wZW4gdGhlIFBERiB0by5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBvcGVuUERGKHBkZjogUERGRGF0YSwgcGFnZTogbnVtYmVyID0gMSkge1xyXG4gICAgICAgIGxldCB7IHVybCwgb2Zmc2V0LCBjYWNoZSB9ID0gcGRmO1xyXG5cclxuICAgICAgICBpZiAodHlwZW9mIG9mZnNldCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgb2Zmc2V0ID0gcGFyc2VJbnQob2Zmc2V0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghUERGVXRpbC52YWxpZGF0ZUFic29sdXRlVVJMKHVybCkpIHtcclxuICAgICAgICAgICAgdXJsID0gUERGVXRpbC5nZXRBYnNvbHV0ZVVSTCh1cmwpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3Qgdmlld2VyID0gbmV3IFBERlZpZXdlcihwZGYpO1xyXG4gICAgICAgIHZpZXdlci5yZW5kZXIodHJ1ZSk7XHJcblxyXG4gICAgICAgIGF3YWl0IF9oYW5kbGVPcGVuKHZpZXdlciwgdXJsLCBwYWdlICsgb2Zmc2V0LCBjYWNoZSk7XHJcblxyXG4gICAgICAgIHJldHVybiB2aWV3ZXI7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBPcGVuIGEgVVJMIGFzIGEgUERGLlxyXG4gICAgICogQHBhcmFtIHVybCBUaGUgVVJMIHRvIG9wZW4gKG11c3QgYmUgYWJzb2x1dGUpLlxyXG4gICAgICogQHBhcmFtIHBhZ2UgV2hpY2ggcGFnZSB0byBvcGVuIHRvLiBNdXN0IGJlID49IDEuXHJcbiAgICAgKiBAcGFyYW0gY2FjaGUgSWYgVVJMIGJhc2VkIGNhY2hpbmcgc2hvdWxkIGJlIHVzZWQuXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgYXN5bmMgb3BlblVSTCh1cmw6IHN0cmluZywgcGFnZTogbnVtYmVyID0gMSwgY2FjaGU6IGJvb2xlYW4gPSB0cnVlKTogUHJvbWlzZTxQREZWaWV3ZXI+IHtcclxuICAgICAgICBpZiAoaXNOYU4ocGFnZSkgfHwgcGFnZSA8PSAwKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgUGFnZSBtdXN0IGJlID4gMCwgYnV0ICR7cGFnZX0gd2FzIGdpdmVuLmApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCFQREZVdGlsLnZhbGlkYXRlQWJzb2x1dGVVUkwodXJsKSkge1xyXG4gICAgICAgICAgICB1cmwgPSBQREZVdGlsLmdldEFic29sdXRlVVJMKHVybCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCB2aWV3ZXIgPSBuZXcgUERGVmlld2VyKCk7XHJcbiAgICAgICAgdmlld2VyLnJlbmRlcih0cnVlKTtcclxuXHJcbiAgICAgICAgYXdhaXQgX2hhbmRsZU9wZW4odmlld2VyLCB1cmwsIHBhZ2UsIGNhY2hlKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHZpZXdlcjtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNob3dzIHRoZSB1c2VyIG1hbnVhbCB0byB0aGUgYWN0aXZlIHVzZXIuXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgYXN5bmMgc2hvd0hlbHAoKSB7XHJcbiAgICAgICAgYXdhaXQgZ2FtZS51c2VyLnNldEZsYWcoUERGU2V0dGluZ3MuRVhURVJOQUxfU1lTVEVNX05BTUUsIFBERlNldHRpbmdzLkhFTFBfU0VFTl9LRVksIHRydWUpO1xyXG5cclxuICAgICAgICBjb25zdCBsYW5nID0gZ2FtZS5pMThuLmxhbmc7XHJcbiAgICAgICAgbGV0IG1hbnVhbFBhdGggPSBgJHt3aW5kb3cub3JpZ2lufS9zeXN0ZW1zLyR7UERGU2V0dGluZ3MuRVhURVJOQUxfU1lTVEVNX05BTUV9LyR7UERGU2V0dGluZ3MuRElTVF9GT0xERVJ9L2Fzc2V0cy9tYW51YWwvJHtsYW5nfS9tYW51YWwucGRmYDtcclxuICAgICAgICBjb25zdCBtYW51YWxFeGlzdHMgPSBhd2FpdCBQREZVdGlsLmZpbGVFeGlzdHMobWFudWFsUGF0aCk7XHJcblxyXG4gICAgICAgIGlmICghbWFudWFsRXhpc3RzKSB7XHJcbiAgICAgICAgICAgIG1hbnVhbFBhdGggPSBgJHt3aW5kb3cub3JpZ2lufS9zeXN0ZW1zLyR7UERGU2V0dGluZ3MuRVhURVJOQUxfU1lTVEVNX05BTUV9LyR7UERGU2V0dGluZ3MuRElTVF9GT0xERVJ9L2Fzc2V0cy9tYW51YWwvZW4vbWFudWFsLnBkZmA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBwZGZEYXRhOiBQREZEYXRhID0ge1xyXG4gICAgICAgICAgICBuYW1lOiBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5NQU5VQUwuTmFtZScpLFxyXG4gICAgICAgICAgICBjb2RlOiAnJyxcclxuICAgICAgICAgICAgb2Zmc2V0OiAwLFxyXG4gICAgICAgICAgICB1cmw6IG1hbnVhbFBhdGgsXHJcbiAgICAgICAgICAgIGNhY2hlOiBmYWxzZSxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4gUERGb3VuZHJ5QVBJLm9wZW5QREYocGRmRGF0YSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cclxufVxyXG4iLCIvKiBDb3B5cmlnaHQgMjAyMCBBbmRyZXcgQ3VjY2luZWxsb1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcblxyXG5pbXBvcnQgeyBQREZTZXR0aW5ncyB9IGZyb20gJy4uL3NldHRpbmdzL1BERlNldHRpbmdzJztcclxuaW1wb3J0IHsgUERGb3VuZHJ5QVBJIH0gZnJvbSAnLi4vYXBpL1BERm91bmRyeUFQSSc7XHJcblxyXG4vKipcclxuICogRXh0ZW5kcyB0aGUgYmFzZSBJdGVtU2hlZXQgZm9yIGxpbmtlZCBQREYgdmlld2luZy5cclxuICogQHByaXZhdGVcclxuICovXHJcbmV4cG9ydCBjbGFzcyBQREZJdGVtU2hlZXQgZXh0ZW5kcyBJdGVtU2hlZXQge1xyXG4gICAgc3RhdGljIGdldCBkZWZhdWx0T3B0aW9ucygpIHtcclxuICAgICAgICBjb25zdCBvcHRpb25zID0gc3VwZXIuZGVmYXVsdE9wdGlvbnM7XHJcbiAgICAgICAgb3B0aW9ucy5jbGFzc2VzID0gWydzaGVldCcsICdpdGVtJ107XHJcbiAgICAgICAgb3B0aW9ucy53aWR0aCA9IDY1MDtcclxuICAgICAgICBvcHRpb25zLmhlaWdodCA9ICdhdXRvJztcclxuICAgICAgICBvcHRpb25zLnRlbXBsYXRlID0gYHN5c3RlbXMvJHtQREZTZXR0aW5ncy5FWFRFUk5BTF9TWVNURU1fTkFNRX0vJHtQREZTZXR0aW5ncy5ESVNUX0ZPTERFUn0vdGVtcGxhdGVzL3NoZWV0L3BkZi1zaGVldC5odG1sYDtcclxuICAgICAgICByZXR1cm4gb3B0aW9ucztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEhlbHBlciBtZXRob2QgdG8gZ2V0IGEgaWQgaW4gdGhlIGh0bWwgZm9ybVxyXG4gICAgICogaHRtbCBpZHMgYXJlIHByZXBlbmRlZCB3aXRoIHRoZSBpZCBvZiB0aGUgaXRlbSB0byBwcmVzZXJ2ZSB1bmlxdWVuZXNzXHJcbiAgICAgKiAgd2hpY2ggaXMgbWFuZGF0b3J5IHRvIGFsbG93IG11bHRpcGxlIGZvcm1zIHRvIGJlIG9wZW5cclxuICAgICAqIEBwYXJhbSBodG1sXHJcbiAgICAgKiBAcGFyYW0gaWRcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBfZ2V0QnlJRChodG1sOiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCBpZDogc3RyaW5nKTogSlF1ZXJ5PEhUTUxFbGVtZW50PiB7XHJcbiAgICAgICAgcmV0dXJuIGh0bWwucGFyZW50KCkucGFyZW50KCkuZmluZChgIyR7dGhpcy5pdGVtLl9pZH0tJHtpZH1gKTtcclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgX2dldEhlYWRlckJ1dHRvbnMoKTogYW55W10ge1xyXG4gICAgICAgIGNvbnN0IGJ1dHRvbnMgPSBzdXBlci5fZ2V0SGVhZGVyQnV0dG9ucygpO1xyXG4gICAgICAgIGJ1dHRvbnMudW5zaGlmdCh7XHJcbiAgICAgICAgICAgIGNsYXNzOiAncGRmLXNoZWV0LW1hbnVhbCcsXHJcbiAgICAgICAgICAgIGljb246ICdmYXMgZmEtcXVlc3Rpb24tY2lyY2xlJyxcclxuICAgICAgICAgICAgbGFiZWw6ICdIZWxwJyxcclxuICAgICAgICAgICAgb25jbGljazogKCkgPT4gUERGb3VuZHJ5QVBJLnNob3dIZWxwKCksXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy9UT0RPOiBTdGFuZGFyZGl6ZSB0aGlzIHRvIGZ1bmN0aW9uIHcvIHRoZSBWaWV3ZXIgb25lXHJcbiAgICAgICAgYnV0dG9ucy51bnNoaWZ0KHtcclxuICAgICAgICAgICAgY2xhc3M6ICdwZGYtc2hlZXQtZ2l0aHViJyxcclxuICAgICAgICAgICAgaWNvbjogJ2ZhcyBmYS1leHRlcm5hbC1saW5rLWFsdCcsXHJcbiAgICAgICAgICAgIGxhYmVsOiAnUERGb3VuZHJ5JyxcclxuICAgICAgICAgICAgb25jbGljazogKCkgPT4gd2luZG93Lm9wZW4oJ2h0dHBzOi8vZ2l0aHViLmNvbS9EanBob2VuaXg3MTkvUERGb3VuZHJ5JywgJ19ibGFuaycpLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBidXR0b25zO1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBhY3RpdmF0ZUxpc3RlbmVycyhodG1sOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KTogdm9pZCB7XHJcbiAgICAgICAgc3VwZXIuYWN0aXZhdGVMaXN0ZW5lcnMoaHRtbCk7XHJcblxyXG4gICAgICAgIGNvbnN0IHVybElucHV0ID0gdGhpcy5fZ2V0QnlJRChodG1sLCAnZGF0YVxcXFwudXJsJyk7XHJcbiAgICAgICAgY29uc3Qgb2Zmc2V0SW5wdXQgPSB0aGlzLl9nZXRCeUlEKGh0bWwsICdkYXRhXFxcXC5vZmZzZXQnKTtcclxuXHJcbiAgICAgICAgLy8gQmxvY2sgZW50ZXIgZnJvbSBkaXNwbGF5aW5nIHRoZSBQREZcclxuICAgICAgICBodG1sLmZpbmQoJ2lucHV0Jykub24oJ2tleXByZXNzJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChldmVudC5rZXkgPT09ICdFbnRlcicpIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gVGVzdCBidXR0b25cclxuICAgICAgICB0aGlzLl9nZXRCeUlEKGh0bWwsICdwZGYtdGVzdCcpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgICAgbGV0IHVybFZhbHVlID0gdXJsSW5wdXQudmFsKCk7XHJcbiAgICAgICAgICAgIGxldCBvZmZzZXRWYWx1ZSA9IG9mZnNldElucHV0LnZhbCgpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHVybFZhbHVlID09PSBudWxsIHx8IHVybFZhbHVlID09PSB1bmRlZmluZWQpIHJldHVybjtcclxuICAgICAgICAgICAgaWYgKG9mZnNldFZhbHVlID09PSBudWxsIHx8IG9mZnNldFZhbHVlID09PSB1bmRlZmluZWQpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIHVybFZhbHVlID0gYCR7d2luZG93LmxvY2F0aW9uLm9yaWdpbn0vJHt1cmxWYWx1ZX1gO1xyXG5cclxuICAgICAgICAgICAgaWYgKG9mZnNldFZhbHVlLnRvU3RyaW5nKCkudHJpbSgpID09PSAnJykge1xyXG4gICAgICAgICAgICAgICAgb2Zmc2V0VmFsdWUgPSAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9mZnNldFZhbHVlID0gcGFyc2VJbnQob2Zmc2V0VmFsdWUgYXMgc3RyaW5nKTtcclxuXHJcbiAgICAgICAgICAgIFBERm91bmRyeUFQSS5vcGVuVVJMKHVybFZhbHVlLCA1ICsgb2Zmc2V0VmFsdWUsIGZhbHNlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gQnJvd3NlIGJ1dHRvblxyXG4gICAgICAgIHRoaXMuX2dldEJ5SUQoaHRtbCwgJ3BkZi1icm93c2UnKS5vbignY2xpY2snLCBhc3luYyBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGZwID0gbmV3IEZpbGVQaWNrZXIoe30pO1xyXG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlIFRPRE86IGZvdW5kcnktcGMtdHlwZXNcclxuICAgICAgICAgICAgZnAuZXh0ZW5zaW9ucyA9IFsnLnBkZiddO1xyXG4gICAgICAgICAgICBmcC5maWVsZCA9IHVybElucHV0WzBdO1xyXG5cclxuICAgICAgICAgICAgbGV0IHVybFZhbHVlID0gdXJsSW5wdXQudmFsKCk7XHJcbiAgICAgICAgICAgIGlmICh1cmxWYWx1ZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBmcC5icm93c2UodXJsVmFsdWUudG9TdHJpbmcoKS50cmltKCkpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmcC5yZW5kZXIodHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgUERGVXRpbCB9IGZyb20gJy4uL2FwaS9QREZVdGlsJztcclxuaW1wb3J0IHsgUERGU2V0dGluZ3MgfSBmcm9tICcuLi9zZXR0aW5ncy9QREZTZXR0aW5ncyc7XHJcbmltcG9ydCB7IFBERkRhdGEgfSBmcm9tICcuLi9hcGkvdHlwZXMvUERGRGF0YSc7XHJcblxyXG5leHBvcnQgdHlwZSBQREZQbGF5ZXJTZWxlY3RDYWxsYmFjayA9IChpZHM6IFtdKSA9PiB2b2lkO1xyXG5leHBvcnQgY2xhc3MgUERGUGxheWVyU2VsZWN0IGV4dGVuZHMgQXBwbGljYXRpb24ge1xyXG4gICAgc3RhdGljIGdldCBkZWZhdWx0T3B0aW9ucygpIHtcclxuICAgICAgICBjb25zdCBvcHRpb25zID0gc3VwZXIuZGVmYXVsdE9wdGlvbnM7XHJcbiAgICAgICAgb3B0aW9ucy5jbGFzc2VzID0gWydzaGVldCcsICdpdGVtJ107XHJcbiAgICAgICAgb3B0aW9ucy50ZW1wbGF0ZSA9IGBzeXN0ZW1zLyR7UERGU2V0dGluZ3MuRVhURVJOQUxfU1lTVEVNX05BTUV9LyR7UERGU2V0dGluZ3MuRElTVF9GT0xERVJ9L3RlbXBsYXRlcy9hcHAvcGRmLXBsYXllci1zZWxlY3QuaHRtbGA7XHJcbiAgICAgICAgb3B0aW9ucy53aWR0aCA9ICdhdXRvJztcclxuICAgICAgICBvcHRpb25zLmhlaWdodCA9ICdhdXRvJztcclxuICAgICAgICBvcHRpb25zLnRpdGxlID0gZ2FtZS5pMThuLmxvY2FsaXplKCdQREZPVU5EUlkuVklFV0VSLlNlbGVjdFBsYXllcnMnKTtcclxuICAgICAgICByZXR1cm4gb3B0aW9ucztcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IGlkcztcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgY2I7XHJcblxyXG4gICAgY29uc3RydWN0b3IoaWRzOiBzdHJpbmdbXSwgY2I6IFBERlBsYXllclNlbGVjdENhbGxiYWNrLCBvcHRpb25zPzogQXBwbGljYXRpb25PcHRpb25zKSB7XHJcbiAgICAgICAgc3VwZXIob3B0aW9ucyk7XHJcblxyXG4gICAgICAgIHRoaXMuaWRzID0gaWRzO1xyXG4gICAgICAgIHRoaXMuY2IgPSBjYjtcclxuICAgIH1cclxuXHJcbiAgICBnZXREYXRhKG9wdGlvbnM/OiBhbnkpOiBhbnkgfCBQcm9taXNlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBzdXBlci5nZXREYXRhKG9wdGlvbnMpO1xyXG5cclxuICAgICAgICBjb25zdCB1c2VyczogYW55W10gPSBbXTtcclxuICAgICAgICBmb3IgKGNvbnN0IGlkIG9mIHRoaXMuaWRzKSB7XHJcbiAgICAgICAgICAgIHVzZXJzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgbmFtZTogZ2FtZS51c2Vycy5nZXQoaWQpLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBpZCxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB1c2Vycy5zb3J0KChhLCBiKSA9PiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUpKTtcclxuXHJcbiAgICAgICAgZGF0YVsndXNlcnMnXSA9IHVzZXJzO1xyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBhY3RpdmF0ZUxpc3RlbmVycyhodG1sOiBKUXVlcnk8SFRNTEVsZW1lbnQ+IHwgSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuICAgICAgICBzdXBlci5hY3RpdmF0ZUxpc3RlbmVycyhodG1sKTtcclxuXHJcbiAgICAgICAgY29uc3QgYnV0dG9uID0gJChodG1sKS5maW5kKCcjY29uZmlybScpO1xyXG4gICAgICAgIGJ1dHRvbi5vbignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY2IodGhpcy5jb2xsZWN0SWRzKGh0bWwpKTtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY29sbGVjdElkcyhodG1sOiBKUXVlcnk8SFRNTEVsZW1lbnQ+IHwgSFRNTEVsZW1lbnQpOiBzdHJpbmdbXSB7XHJcbiAgICAgICAgY29uc3QgaWRzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgICAgIGNvbnN0IGNoZWNrYm94ZXMgPSAkKGh0bWwpLmZpbmQoJ2lucHV0W3R5cGU9Y2hlY2tib3hdJyk7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGVja2JveGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNoZWNrYm94ID0gJChjaGVja2JveGVzW2ldKTtcclxuICAgICAgICAgICAgaWYgKGNoZWNrYm94LnByb3AoJ2NoZWNrZWQnKSkge1xyXG4gICAgICAgICAgICAgICAgaWRzLnB1c2goY2hlY2tib3gucHJvcCgnaWQnKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGlkcztcclxuICAgIH1cclxufVxyXG4iLCIvKiBDb3B5cmlnaHQgMjAyMCBBbmRyZXcgQ3VjY2luZWxsb1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmltcG9ydCB7IFBERlZpZXdlciB9IGZyb20gJy4uL3ZpZXdlci9QREZWaWV3ZXInO1xyXG5pbXBvcnQgeyBQREZTZXR0aW5ncyB9IGZyb20gJy4uL3NldHRpbmdzL1BERlNldHRpbmdzJztcclxuXHJcbi8qKlxyXG4gKiBBbiBlcnJvciB0aGF0IG9jY3VycyBkdXJpbmcgY2FjaGUgb3BlcmF0aW9uc1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIENhY2hlRXJyb3IgZXh0ZW5kcyBFcnJvciB7XHJcbiAgICBjb25zdHJ1Y3RvcihpbmRleDogc3RyaW5nLCBzdG9yZTogc3RyaW5nLCBtZXNzYWdlPzogc3RyaW5nKSB7XHJcbiAgICAgICAgc3VwZXIoYEVycm9yIGluICR7aW5kZXh9PiR7c3RvcmV9OiAke21lc3NhZ2V9YCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDbGFzcyB0aGF0IGRlYWxzIHdpdGggZ2V0dGluZy9zZXR0aW5nIGZyb20gYW4gaW5kZXhlZCBkYlxyXG4gKiBNb3N0bHkgZXhpc3RzIHRvIHNlcGFyYXRlIGxvZ2ljIGZvciB0aGUgUERGQ2FjaGUgZnJvbSBsb2dpY1xyXG4gKiBkZWFsaW5nIHdpdGggdGhlIGRhdGFiYXNlXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5jbGFzcyBJREJIZWxwZXIge1xyXG4gICAgcHJpdmF0ZSBfdmVyc2lvbjogbnVtYmVyO1xyXG5cclxuICAgIHByaXZhdGUgcmVhZG9ubHkgX2luZGV4TmFtZTogc3RyaW5nO1xyXG4gICAgcHJpdmF0ZSByZWFkb25seSBfc3RvcmVOYW1lczogc3RyaW5nW107XHJcblxyXG4gICAgcHJpdmF0ZSBfZGI6IElEQkRhdGFiYXNlO1xyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgYXN5bmMgY3JlYXRlQW5kT3BlbihpbmRleE5hbWU6IHN0cmluZywgc3RvcmVOYW1lczogc3RyaW5nW10sIHZlcnNpb246IG51bWJlcikge1xyXG4gICAgICAgIGNvbnN0IGhlbHBlciA9IG5ldyBJREJIZWxwZXIoaW5kZXhOYW1lLCBzdG9yZU5hbWVzLCB2ZXJzaW9uKTtcclxuICAgICAgICBhd2FpdCBoZWxwZXIub3BlbigpO1xyXG4gICAgICAgIHJldHVybiBoZWxwZXI7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldCByZWFkeSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZGIgIT09IHVuZGVmaW5lZDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY29uc3RydWN0b3IoaW5kZXhOYW1lOiBzdHJpbmcsIHN0b3JlTmFtZXM6IHN0cmluZ1tdLCB2ZXJzaW9uOiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLl9pbmRleE5hbWUgPSBgJHtpbmRleE5hbWV9YDtcclxuICAgICAgICB0aGlzLl9zdG9yZU5hbWVzID0gc3RvcmVOYW1lcztcclxuICAgICAgICB0aGlzLl92ZXJzaW9uID0gdmVyc2lvbjtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIG5ld1RyYW5zYWN0aW9uKHN0b3JlTmFtZTogc3RyaW5nKSB7XHJcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSB0aGlzLl9kYi50cmFuc2FjdGlvbihzdG9yZU5hbWUsICdyZWFkd3JpdGUnKTtcclxuICAgICAgICBjb25zdCBzdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKHN0b3JlTmFtZSk7XHJcbiAgICAgICAgcmV0dXJuIHsgdHJhbnNhY3Rpb24sIHN0b3JlIH07XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG9wZW4oKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICAgICAgY29uc3QgdGhhdCA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPHZvaWQ+KGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgY29uc3QgcmVxdWVzdCA9IGluZGV4ZWREQi5vcGVuKHRoYXQuX2luZGV4TmFtZSwgdGhhdC5fdmVyc2lvbik7XHJcbiAgICAgICAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICB0aGF0Ll9kYiA9IHRoaXMucmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICByZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgdGhhdC5fZGIgPSB0aGlzLnJlc3VsdDtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhhdC5fc3RvcmVOYW1lcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBvYmplY3Qgc3RvcmUgaWYgaXQgZG9lc24ndCBleGlzdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGF0Ll9kYi5jcmVhdGVPYmplY3RTdG9yZSh0aGF0Ll9zdG9yZU5hbWVzW2ldLCB7fSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gT3RoZXJ3aXNlIHBhc3NcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxyXG4gICAgICAgICAgICAgICAgcmVqZWN0KGV2ZW50LnRhcmdldC5lcnJvcik7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNldChrZXk6IElEQlZhbGlkS2V5LCB2YWx1ZTogYW55LCBzdG9yZU5hbWU6IHN0cmluZywgZm9yY2U6IGJvb2xlYW4gPSBmYWxzZSk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZTx2b2lkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5fZGIpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBDYWNoZUVycm9yKHRoaXMuX2luZGV4TmFtZSwgc3RvcmVOYW1lLCAnRGF0YWJhc2UgaXMgbm90IGluaXRpYWxpemVkLicpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdGhhdCA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICBsZXQgeyB0cmFuc2FjdGlvbiwgc3RvcmUgfSA9IHRoaXMubmV3VHJhbnNhY3Rpb24oc3RvcmVOYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBQcm9wYWdhdGUgZXJyb3JzIHVwd2FyZHMsIG90aGVyd2lzZSB0aGV5IGZhaWwgc2lsZW50bHlcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uLm9uZXJyb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGV2ZW50LnRhcmdldC5lcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IGtleVJlcXVlc3QgPSBzdG9yZS5nZXRLZXkoa2V5KTtcclxuICAgICAgICAgICAgICAgIGtleVJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8ga2V5IGFscmVhZHkgZXhpc3RzIGluIHRoZSBzdG9yZVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChrZXlSZXF1ZXN0LnJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzaG91bGQgd2UgZm9yY2UgdGhlIG5ldyB2YWx1ZSBieSBkZWxldGluZyB0aGUgb2xkP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm9yY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuZGVsKGtleSwgc3RvcmVOYW1lKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoeyB0cmFuc2FjdGlvbiwgc3RvcmUgfSA9IHRoYXQubmV3VHJhbnNhY3Rpb24oc3RvcmVOYW1lKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmUuYWRkKHZhbHVlLCBrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IENhY2hlRXJyb3IodGhhdC5faW5kZXhOYW1lLCBzdG9yZU5hbWUsIGBLZXkgJHtrZXl9IGFscmVhZHkgZXhpc3RzLmApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmUuYWRkKHZhbHVlLCBrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXQoa2V5OiBJREJWYWxpZEtleSwgc3RvcmVOYW1lOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZTx2b2lkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5fZGIpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBDYWNoZUVycm9yKHRoaXMuX2luZGV4TmFtZSwgc3RvcmVOYW1lLCAnRGF0YWJhc2UgaXMgbm90IGluaXRpYWxpemVkLicpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbGV0IHsgdHJhbnNhY3Rpb24sIHN0b3JlIH0gPSB0aGlzLm5ld1RyYW5zYWN0aW9uKHN0b3JlTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gUHJvcGFnYXRlIGVycm9ycyB1cHdhcmRzLCBvdGhlcndpc2UgdGhleSBmYWlsIHNpbGVudGx5XHJcbiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbi5vbmVycm9yID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChldmVudC50YXJnZXQuZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBnZXRSZXF1ZXN0ID0gc3RvcmUuZ2V0KGtleSk7XHJcbiAgICAgICAgICAgICAgICBnZXRSZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUodGhpcy5yZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBnZXRSZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGV2ZW50LnRhcmdldC5lcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGRlbChrZXk6IElEQlZhbGlkS2V5LCBzdG9yZU5hbWU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZTx2b2lkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IHRyYW5zYWN0aW9uLCBzdG9yZSB9ID0gdGhpcy5uZXdUcmFuc2FjdGlvbihzdG9yZU5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uLm9uZXJyb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGV2ZW50LnRhcmdldC5lcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb24ub25jb21wbGV0ZSA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgc3RvcmUuZGVsZXRlKGtleSk7XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGtleXMoc3RvcmVOYW1lOiBzdHJpbmcpOiBQcm9taXNlPElEQlZhbGlkS2V5W10+IHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8SURCVmFsaWRLZXlbXT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgeyB0cmFuc2FjdGlvbiwgc3RvcmUgfSA9IHRoaXMubmV3VHJhbnNhY3Rpb24oc3RvcmVOYW1lKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGtleXNSZXF1ZXN0ID0gc3RvcmUuZ2V0QWxsS2V5cygpO1xyXG5cclxuICAgICAgICAgICAgICAgIGtleXNSZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGtleXNSZXF1ZXN0LnJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAga2V5c1JlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXZlbnQudGFyZ2V0LmVycm9yKTtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjbHIoc3RvcmVOYW1lOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgeyBzdG9yZSB9ID0gdGhpcy5uZXdUcmFuc2FjdGlvbihzdG9yZU5hbWUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qga2V5cyA9IHN0b3JlLmdldEFsbEtleXMoKTtcclxuICAgICAgICAgICAgICAgIGtleXMub25zdWNjZXNzID0gKHJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByb21pc2VzOiBQcm9taXNlPHZvaWQ+W10gPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzLnJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKHRoaXMuZGVsKGtleSwgc3RvcmVOYW1lKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIE1ldGEgaW5mb3JtYXRpb24gYWJvdXQgYSBjYWNoZSBlbnRyeVxyXG4gKi9cclxudHlwZSBDYWNoZU1ldGEgPSB7XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBzaXplIGluIGJ5dGVzIHRoaXMgY2FjaGUgZW50cnkgdGFrZXMgdXAuXHJcbiAgICAgKi9cclxuICAgIHNpemU6IG51bWJlcjtcclxuICAgIC8qKlxyXG4gICAgICogVGhlIGRhdGUgdGhlIGNhY2hlIHdhcyBsYXN0IGFjY2Vzc2VkLCByZXByZXNlbnRlZCBieSBhIElTTyBzdHJpbmcuXHJcbiAgICAgKi9cclxuICAgIGRhdGVBY2Nlc3NlZDogc3RyaW5nO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEhhbmRsZXMgY2FjaGluZyBmb3IgUERGc1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFBERkNhY2hlIHtcclxuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiU3RhdGljIFByb3BlcnRpZXNcIj5cclxuICAgIC8qKlxyXG4gICAgICogTWF4IHNpemUgb2YgdGhlIGNhY2hlIGZvciB0aGUgYWN0aXZlIHVzZXIsIGRlZmF1bHRzIHRvIDI1NiBNQi5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXQgTUFYX0JZVEVTKCkge1xyXG4gICAgICAgIHJldHVybiBnYW1lLnNldHRpbmdzLmdldChQREZTZXR0aW5ncy5FWFRFUk5BTF9TWVNURU1fTkFNRSwgJ0NhY2hlU2l6ZScpICogMiAqKiAyMDtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBJREJfTkFNRTogc3RyaW5nID0gJ1BERm91bmRyeSc7XHJcbiAgICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBJREJfVkVSU0lPTjogbnVtYmVyID0gMTtcclxuXHJcbiAgICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBDQUNIRTogc3RyaW5nID0gYENhY2hlYDtcclxuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IE1FVEE6IHN0cmluZyA9IGBNZXRhYDtcclxuXHJcbiAgICBwcml2YXRlIHN0YXRpYyBfY2FjaGVIZWxwZXI6IElEQkhlbHBlcjtcclxuICAgIC8vIDwvZWRpdG9yLWZvbGQ+XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBpbml0aWFsaXplKCkge1xyXG4gICAgICAgIFBERkNhY2hlLl9jYWNoZUhlbHBlciA9IGF3YWl0IElEQkhlbHBlci5jcmVhdGVBbmRPcGVuKFBERkNhY2hlLklEQl9OQU1FLCBbUERGQ2FjaGUuQ0FDSEUsIFBERkNhY2hlLk1FVEFdLCBQREZDYWNoZS5JREJfVkVSU0lPTik7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgbWV0YSBpbmZvcm1hdGlvbiBhYm91dCBhIHByb3ZpZGVkIGtleSAodXJsKS5cclxuICAgICAqIEBwYXJhbSBrZXlcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBnZXRNZXRhKGtleTogc3RyaW5nKTogUHJvbWlzZTxDYWNoZU1ldGEgfCBudWxsPiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IFBERkNhY2hlLl9jYWNoZUhlbHBlci5nZXQoa2V5LCBQREZDYWNoZS5NRVRBKTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXQgbWV0YSBpbmZvcm1hdGlvbiBhYm91dCBhIHByb3ZpZGVkIGtleSAodXJsKS4gU2VlIHtAbGluayBDYWNoZU1ldGF9LlxyXG4gICAgICogQHBhcmFtIGtleVxyXG4gICAgICogQHBhcmFtIG1ldGFcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBzZXRNZXRhKGtleTogc3RyaW5nLCBtZXRhOiBDYWNoZU1ldGEpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICBhd2FpdCBQREZDYWNoZS5fY2FjaGVIZWxwZXIuc2V0KGtleSwgbWV0YSwgUERGQ2FjaGUuTUVUQSwgdHJ1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgdGhlIGJ5dGUgYXJyYXkgcmVwcmVzZW50aW5nIHRoZSBrZXkgKHVybCkgZnJvbSB0aGUgdXNlcidzIGNhY2hlLlxyXG4gICAgICogQHBhcmFtIGtleVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIGdldENhY2hlKGtleTogc3RyaW5nKTogUHJvbWlzZTxVaW50OEFycmF5IHwgbnVsbD4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ5dGVzID0gYXdhaXQgUERGQ2FjaGUuX2NhY2hlSGVscGVyLmdldChrZXksIFBERkNhY2hlLkNBQ0hFKTtcclxuICAgICAgICAgICAgY29uc3QgbWV0YTogQ2FjaGVNZXRhID0ge1xyXG4gICAgICAgICAgICAgICAgZGF0ZUFjY2Vzc2VkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICBzaXplOiBieXRlcy5sZW5ndGgsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGF3YWl0IFBERkNhY2hlLnNldE1ldGEoa2V5LCBtZXRhKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBieXRlcztcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXQgdGhlIHZhbHVlIG9mIHRoZSBjYWNoZSBmb3IgdGhlIHNwZWNpZmljIGtleSAodXJsKSB0byB0aGUgcHJvdmlkZWQgYnl0ZSBhcnJheS5cclxuICAgICAqIEBwYXJhbSBrZXlcclxuICAgICAqIEBwYXJhbSBieXRlc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIHNldENhY2hlKGtleTogc3RyaW5nLCBieXRlczogVWludDhBcnJheSkge1xyXG4gICAgICAgIGNvbnN0IG1ldGE6IENhY2hlTWV0YSA9IHtcclxuICAgICAgICAgICAgZGF0ZUFjY2Vzc2VkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgIHNpemU6IGJ5dGVzLmxlbmd0aCxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBhd2FpdCBQREZDYWNoZS5fY2FjaGVIZWxwZXIuc2V0KGtleSwgYnl0ZXMsIFBERkNhY2hlLkNBQ0hFLCB0cnVlKTtcclxuICAgICAgICBhd2FpdCBQREZDYWNoZS5zZXRNZXRhKGtleSwgbWV0YSk7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5wcnVuZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJlbG9hZCB0aGUgUERGIGF0IHRoZSBzcGVjaWZpZWQga2V5ICh1cmwpLCBjYWNoaW5nIGl0IGltbWVkaWF0ZWx5LlxyXG4gICAgICogQHBhcmFtIGtleVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIHByZWxvYWQoa2V5OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8dm9pZD4oYXN5bmMgKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjYWNoZWRCeXRlcyA9IGF3YWl0IFBERkNhY2hlLmdldENhY2hlKGtleSk7XHJcbiAgICAgICAgICAgIGlmIChjYWNoZWRCeXRlcyAhPT0gbnVsbCAmJiBjYWNoZWRCeXRlcy5ieXRlTGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGtleSk7XHJcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5vaykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZmV0Y2hlZEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYXdhaXQgcmVzcG9uc2UuYXJyYXlCdWZmZXIoKSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZmV0Y2hlZEJ5dGVzLmJ5dGVMZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgUERGQ2FjaGUuc2V0Q2FjaGUoa2V5LCBmZXRjaGVkQnl0ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCgnRmV0Y2ggZmFpbGVkLicpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KCdGZXRjaCBmYWlsZWQuJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFBydW5lIHRoZSBhY3RpdmUgdXNlcidzIGNhY2hlIHVudGlsIGl0IGlzIGJlbG93IHRoZSB1c2VyJ3MgY2FjaGUgc2l6ZSBsaW1pdC5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBwcnVuZSgpIHtcclxuICAgICAgICBjb25zdCBrZXlzID0gYXdhaXQgdGhpcy5fY2FjaGVIZWxwZXIua2V5cyhQREZDYWNoZS5NRVRBKTtcclxuXHJcbiAgICAgICAgbGV0IHRvdGFsQnl0ZXMgPSAwO1xyXG4gICAgICAgIGxldCBtZXRhczogYW55W10gPSBbXTtcclxuICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1ldGEgPSBhd2FpdCB0aGlzLl9jYWNoZUhlbHBlci5nZXQoa2V5LCBQREZDYWNoZS5NRVRBKTtcclxuICAgICAgICAgICAgbWV0YS5kYXRlQWNjZXNzZWQgPSBEYXRlLnBhcnNlKG1ldGEuZGF0ZUFjY2Vzc2VkKTtcclxuICAgICAgICAgICAgbWV0YS5zaXplID0gcGFyc2VJbnQobWV0YS5zaXplKTtcclxuXHJcbiAgICAgICAgICAgIHRvdGFsQnl0ZXMgKz0gbWV0YS5zaXplO1xyXG5cclxuICAgICAgICAgICAgbWV0YXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBrZXksXHJcbiAgICAgICAgICAgICAgICBtZXRhLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG1ldGFzID0gbWV0YXMuc29ydCgoYSwgYikgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gYS5tZXRhLmRhdGVBY2Nlc3NlZCAtIGIubWV0YS5kYXRlQWNjZXNzZWQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWV0YXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKHRvdGFsQnl0ZXMgPCBQREZDYWNoZS5NQVhfQllURVMpIHtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBuZXh0ID0gbWV0YXNbaV07XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLl9jYWNoZUhlbHBlci5kZWwobmV4dC5rZXksIFBERkNhY2hlLk1FVEEpO1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLl9jYWNoZUhlbHBlci5kZWwobmV4dC5rZXksIFBERkNhY2hlLkNBQ0hFKTtcclxuXHJcbiAgICAgICAgICAgIHRvdGFsQnl0ZXMgLT0gbmV4dC5tZXRhLnNpemU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiIsIi8qIENvcHlyaWdodCAyMDIwIEFuZHJldyBDdWNjaW5lbGxvXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFBERlNldHVwIH0gZnJvbSAnLi9zZXR1cC9QREZTZXR1cCc7XHJcbmltcG9ydCB7IFBERkNhY2hlIH0gZnJvbSAnLi9jYWNoZS9QREZDYWNoZSc7XHJcbmltcG9ydCB7IFBERkV2ZW50cyB9IGZyb20gJy4vYXBpL1BERkV2ZW50cyc7XHJcbmltcG9ydCB7IFBERkkxOG4gfSBmcm9tICcuL3NldHRpbmdzL1BERkkxOG4nO1xyXG5pbXBvcnQgeyBQREZTZXR0aW5ncyB9IGZyb20gJy4vc2V0dGluZ3MvUERGU2V0dGluZ3MnO1xyXG5pbXBvcnQgeyBQREZTb2NrZXRIYW5kbGVyIH0gZnJvbSAnLi9zb2NrZXQvUERGU29ja2V0SGFuZGxlcic7XHJcbmltcG9ydCB7IFBERm91bmRyeUFQSSB9IGZyb20gJy4vYXBpL1BERm91bmRyeUFQSSc7XHJcblxyXG5QREZTZXR1cC5yZWdpc3RlclN5c3RlbSgpO1xyXG5QREZTZXR1cC5yZWdpc3RlckFQSSgpO1xyXG5cclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5jb25zdCBpbml0ID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgLy8gSW5qZWN0IHRoZSBjc3MgaW50byB0aGUgcGFnZVxyXG4gICAgUERGU2V0dXAucmVnaXN0ZXJDU1MoKTtcclxuXHJcbiAgICBQREZFdmVudHMuZmlyZSgnaW5pdCcsIFBERm91bmRyeUFQSSk7XHJcblxyXG4gICAgYXdhaXQgc2V0dXAoKTtcclxufTtcclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5jb25zdCBzZXR1cCA9IGFzeW5jICgpID0+IHtcclxuICAgIC8vIEluaXRpYWxpemUgdGhlIGNhY2hlIHN5c3RlbSwgY3JlYXRpbmcgdGhlIERCXHJcbiAgICBhd2FpdCBQREZDYWNoZS5pbml0aWFsaXplKCk7XHJcbiAgICAvLyBMb2FkIHRoZSByZWxldmFudCBpbnRlcm5hdGlvbmFsaXphdGlvbiBmaWxlLlxyXG4gICAgYXdhaXQgUERGSTE4bi5pbml0aWFsaXplKCk7XHJcblxyXG4gICAgUERGRXZlbnRzLmZpcmUoJ3NldHVwJywgUERGb3VuZHJ5QVBJKTtcclxufTtcclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5jb25zdCByZWFkeSA9IGFzeW5jICgpID0+IHtcclxuICAgIC8vIFJlZ2lzdGVyIHRoZSBQREYgc2hlZXQgd2l0aCB0aGUgY2xhc3MgcGlja2VyLCB1bnJlZ2lzdGVyIG90aGVyc1xyXG4gICAgUERGU2V0dXAuZm91bmRyeUNvbmZpZygpO1xyXG4gICAgLy8gSW5pdGlhbGl6ZSB0aGUgc2V0dGluZ3NcclxuICAgIGF3YWl0IFBERlNldHRpbmdzLnJlZ2lzdGVyU2V0dGluZ3MoKTtcclxuXHJcbiAgICBQREZTZXR1cC51c2VyTG9naW4oKTtcclxuXHJcbiAgICBQREZTb2NrZXRIYW5kbGVyLnJlZ2lzdGVySGFuZGxlcnMoKTtcclxuXHJcbiAgICBQREZFdmVudHMuZmlyZSgncmVhZHknLCBQREZvdW5kcnlBUEkpO1xyXG59O1xyXG5cclxuSG9va3Mub25jZSgnc2V0dXAnLCBpbml0KTtcclxuSG9va3Mub25jZSgncmVhZHknLCByZWFkeSk7XHJcblxyXG4vLyA8ZWRpdG9yLWZvbGQgZGVzYz1cIlBlcnNpc3RlbnQgSG9va3NcIj5cclxuXHJcbi8vIHByZUNyZWF0ZUl0ZW0gLSBTZXR1cCBkZWZhdWx0IHZhbHVlcyBmb3IgYSBuZXcgUERGb3VuZHJ5X1BERlxyXG5Ib29rcy5vbigncHJlQ3JlYXRlSXRlbScsIFBERlNldHVwLnByZUNyZWF0ZUl0ZW0pO1xyXG4vLyBnZXRJdGVtRGlyZWN0b3J5RW50cnlDb250ZXh0IC0gU2V0dXAgY29udGV4dCBtZW51IGZvciAnT3BlbiBQREYnIGxpbmtzXHJcbkhvb2tzLm9uKCdnZXRJdGVtRGlyZWN0b3J5RW50cnlDb250ZXh0JywgUERGU2V0dXAuZ2V0SXRlbUNvbnRleHRPcHRpb25zKTtcclxuLy8gcmVuZGVyU2V0dGluZ3MgLSBJbmplY3QgYSAnT3BlbiBNYW51YWwnIGJ1dHRvbiBpbnRvIGhlbHAgc2VjdGlvblxyXG5Ib29rcy5vbigncmVuZGVyU2V0dGluZ3MnLCBQREZTZXR1cC5vblJlbmRlclNldHRpbmdzKTtcclxuXHJcbi8vIDwvZWRpdG9yLWZvbGQ+XHJcbiIsIi8qIENvcHlyaWdodCAyMDIwIEFuZHJldyBDdWNjaW5lbGxvXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFBERlNldHRpbmdzIH0gZnJvbSAnLi9QREZTZXR0aW5ncyc7XHJcblxyXG4vKipcclxuICogTG9jYWxpemF0aW9uIGhlbHBlclxyXG4gKiBAcHJpdmF0ZVxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFBERkkxOG4ge1xyXG4gICAgLyoqXHJcbiAgICAgKiBMb2FkIHRoZSBsb2NhbGl6YXRpb24gZmlsZSBmb3IgdGhlIHVzZXIncyBsYW5ndWFnZS5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBpbml0aWFsaXplKCkge1xyXG4gICAgICAgIGNvbnN0IGxhbmcgPSBnYW1lLmkxOG4ubGFuZztcclxuICAgICAgICAvLyB1c2VyJ3MgbGFuZ3VhZ2UgcGF0aFxyXG4gICAgICAgIGNvbnN0IHVfcGF0aCA9IGBzeXN0ZW1zLyR7UERGU2V0dGluZ3MuRVhURVJOQUxfU1lTVEVNX05BTUV9LyR7UERGU2V0dGluZ3MuRElTVF9GT0xERVJ9L2xvY2FsZS8ke2xhbmd9L2NvbmZpZy5qc29uYDtcclxuICAgICAgICAvLyBlbmdsaXNoIGZhbGxiYWNrIHBhdGhcclxuICAgICAgICBjb25zdCBmX3BhdGggPSBgc3lzdGVtcy8ke1BERlNldHRpbmdzLkVYVEVSTkFMX1NZU1RFTV9OQU1FfS8ke1BERlNldHRpbmdzLkRJU1RfRk9MREVSfS9sb2NhbGUvZW4vY29uZmlnLmpzb25gO1xyXG5cclxuICAgICAgICBsZXQganNvbjtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBqc29uID0gYXdhaXQgJC5nZXRKU09OKHVfcGF0aCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgLy8gaWYgbm8gdHJhbnNsYXRpb24gZXhpdHMgZm9yIHRoZSB1c2VycyBsb2NhbGUgdGhlIGZhbGxiYWNrXHJcbiAgICAgICAgICAgIGpzb24gPSBhd2FpdCAkLmdldEpTT04oZl9wYXRoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKGpzb24pKSB7XHJcbiAgICAgICAgICAgIGdhbWUuaTE4bi50cmFuc2xhdGlvbnNba2V5XSA9IGpzb25ba2V5XTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIHNldHVwIHRoZSBmYWxsYmFjayBhcyBlbmdsaXNoIHNvIHBhcnRpYWwgdHJhbnNsYXRpb25zIGRvIG5vdCBkaXNwbGF5IGtleXNcclxuICAgICAgICBsZXQgZmJfanNvbiA9IGF3YWl0ICQuZ2V0SlNPTihmX3BhdGgpO1xyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKGZiX2pzb24pKSB7XHJcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgICAgICAgZ2FtZS5pMThuLl9mYWxsYmFja1trZXldID0ganNvbltrZXldO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iLCIvKiBDb3B5cmlnaHQgMjAyMCBBbmRyZXcgQ3VjY2luZWxsb1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcblxyXG5pbXBvcnQgeyBQREZvdW5kcnlBUEkgfSBmcm9tICcuLi9hcGkvUERGb3VuZHJ5QVBJJztcclxuaW1wb3J0IHsgUERGQ2FjaGUgfSBmcm9tICcuLi9jYWNoZS9QREZDYWNoZSc7XHJcbmltcG9ydCB7IFBERlV0aWwgfSBmcm9tICcuLi9hcGkvUERGVXRpbCc7XHJcbmltcG9ydCB7IFBERlByZWxvYWRFdmVudCB9IGZyb20gJy4uL3NvY2tldC9ldmVudHMvUERGUHJlbG9hZEV2ZW50JztcclxuXHJcbi8qKlxyXG4gKiBJbnRlcm5hbCBzZXR0aW5ncyBhbmQgaGVscGVyIG1ldGhvZHMgZm9yIFBERm91bmRyeS5cclxuICogQHByaXZhdGVcclxuICovXHJcbmV4cG9ydCBjbGFzcyBQREZTZXR0aW5ncyB7XHJcbiAgICAvKipcclxuICAgICAqIEFyZSBmZWVkYmFjayBub3RpZmljYXRpb25zIGVuYWJsZWQ/IERpc2FibGUgaWYgeW91IHdpc2hcclxuICAgICAqICB0byBoYW5kbGUgdGhlbSB5b3Vyc2VsZi5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBOT1RJRklDQVRJT05TOiBib29sZWFuID0gdHJ1ZTtcclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIERJU1RfRk9MREVSOiBzdHJpbmcgPSAncGRmb3VuZHJ5LWRpc3QnO1xyXG4gICAgcHVibGljIHN0YXRpYyBFWFRFUk5BTF9TWVNURU1fTkFNRTogc3RyaW5nID0gJy4uL21vZHVsZXMvcGRmb3VuZHJ5JztcclxuICAgIHB1YmxpYyBzdGF0aWMgSU5URVJOQUxfTU9EVUxFX05BTUU6IHN0cmluZyA9ICdwZGZvdW5kcnknO1xyXG4gICAgcHVibGljIHN0YXRpYyBQREZfRU5USVRZX1RZUEU6IHN0cmluZyA9ICdQREZvdW5kcnlfUERGJztcclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIFNFVFRJTkdfRVhJU1RJTkdfVklFV0VSID0gJ1Nob3dJbkV4aXN0aW5nVmlld2VyJztcclxuICAgIHB1YmxpYyBzdGF0aWMgU0VUVElOR19DQUNIRV9TSVpFID0gJ0NhY2hlU2l6ZSc7XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBIRUxQX1NFRU5fS0VZOiBzdHJpbmcgPSAnUERGb3VuZHJ5X0hlbHBTZWVuJztcclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIGdldCBTT0NLRVRfTkFNRSgpIHtcclxuICAgICAgICByZXR1cm4gYHN5c3RlbS4ke1BERlNldHRpbmdzLkVYVEVSTkFMX1NZU1RFTV9OQU1FfWA7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyByZWdpc3RlclNldHRpbmdzKCkge1xyXG4gICAgICAgIFBERlNldHRpbmdzLnJlZ2lzdGVyKFBERlNldHRpbmdzLlNFVFRJTkdfQ0FDSEVfU0laRSwge1xyXG4gICAgICAgICAgICBuYW1lOiBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5TRVRUSU5HUy5DYWNoZVNpemVOYW1lJyksXHJcbiAgICAgICAgICAgIHNjb3BlOiAndXNlcicsXHJcbiAgICAgICAgICAgIHR5cGU6IE51bWJlcixcclxuICAgICAgICAgICAgaGludDogZ2FtZS5pMThuLmxvY2FsaXplKCdQREZPVU5EUlkuU0VUVElOR1MuQ2FjaGVTaXplSGludCcpLFxyXG4gICAgICAgICAgICBkZWZhdWx0OiAyNTYsXHJcbiAgICAgICAgICAgIGNvbmZpZzogdHJ1ZSxcclxuICAgICAgICAgICAgb25DaGFuZ2U6IGFzeW5jIChtYikgPT4ge1xyXG4gICAgICAgICAgICAgICAgbWIgPSBNYXRoLnJvdW5kKG1iKTtcclxuICAgICAgICAgICAgICAgIG1iID0gTWF0aC5tYXgobWIsIDY0KTtcclxuICAgICAgICAgICAgICAgIG1iID0gTWF0aC5taW4obWIsIDEwMjQpO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgUERGU2V0dGluZ3Muc2V0KFBERlNldHRpbmdzLlNFVFRJTkdfQ0FDSEVfU0laRSwgbWIpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBQREZTZXR0aW5ncy5yZWdpc3RlcihQREZTZXR0aW5ncy5TRVRUSU5HX0VYSVNUSU5HX1ZJRVdFUiwge1xyXG4gICAgICAgICAgICBuYW1lOiBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5TRVRUSU5HUy5TaG93SW5FeGlzdGluZ1ZpZXdlck5hbWUnKSxcclxuICAgICAgICAgICAgc2NvcGU6ICd1c2VyJyxcclxuICAgICAgICAgICAgdHlwZTogQm9vbGVhbixcclxuICAgICAgICAgICAgaGludDogZ2FtZS5pMThuLmxvY2FsaXplKCdQREZPVU5EUlkuU0VUVElOR1MuU2hvd0luRXhpc3RpbmdWaWV3ZXJIaW50JyksXHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IHRydWUsXHJcbiAgICAgICAgICAgIGNvbmZpZzogdHJ1ZSxcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFdyYXBwZXIgYXJvdW5kIGdhbWUuc2V0dGluZ3MucmVnaXN0ZXIuIEVuc3VyZXMgc2NvcGUgaXMgY29ycmVjdC5cclxuICAgICAqIEBwYXJhbSBrZXlcclxuICAgICAqIEBwYXJhbSBkYXRhXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgcmVnaXN0ZXIoa2V5OiBzdHJpbmcsIGRhdGE6IGFueSkge1xyXG4gICAgICAgIGdhbWUuc2V0dGluZ3MucmVnaXN0ZXIoUERGU2V0dGluZ3MuRVhURVJOQUxfU1lTVEVNX05BTUUsIGtleSwgZGF0YSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBXcmFwcGVyIGFyb3VuZCBnYW1lLnNldHRpbmdzLmdldC4gRW5zdXJlcyBzY29wZSBpcyBjb3JyZWN0LlxyXG4gICAgICogQHBhcmFtIGtleVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGdldChrZXk6IHN0cmluZykge1xyXG4gICAgICAgIHJldHVybiBnYW1lLnNldHRpbmdzLmdldChQREZTZXR0aW5ncy5FWFRFUk5BTF9TWVNURU1fTkFNRSwga2V5KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFdyYXBwZXIgYXJvdW5kIGdhbWUuc2V0dGluZ3Muc2V0LiBFbnN1cmVzIHNjb3BlIGlzIGNvcnJlY3QuXHJcbiAgICAgKiBAcGFyYW0ga2V5XHJcbiAgICAgKiBAcGFyYW0gdmFsdWVcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBzZXQoa2V5OiBzdHJpbmcsIHZhbHVlOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4gZ2FtZS5zZXR0aW5ncy5zZXQoUERGU2V0dGluZ3MuRVhURVJOQUxfU1lTVEVNX05BTUUsIGtleSwgdmFsdWUpO1xyXG4gICAgfVxyXG59XHJcbiIsIi8qIENvcHlyaWdodCAyMDIwIEFuZHJldyBDdWNjaW5lbGxvXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFBERlNldHRpbmdzIH0gZnJvbSAnLi4vc2V0dGluZ3MvUERGU2V0dGluZ3MnO1xyXG5pbXBvcnQgeyBQREZJdGVtU2hlZXQgfSBmcm9tICcuLi9hcHAvUERGSXRlbVNoZWV0JztcclxuaW1wb3J0IHsgUERGb3VuZHJ5QVBJIH0gZnJvbSAnLi4vYXBpL1BERm91bmRyeUFQSSc7XHJcbmltcG9ydCB7IFBERlV0aWwgfSBmcm9tICcuLi9hcGkvUERGVXRpbCc7XHJcbmltcG9ydCB7IFBERlByZWxvYWRFdmVudCB9IGZyb20gJy4uL3NvY2tldC9ldmVudHMvUERGUHJlbG9hZEV2ZW50JztcclxuaW1wb3J0IHsgUERGQ2FjaGUgfSBmcm9tICcuLi9jYWNoZS9QREZDYWNoZSc7XHJcblxyXG4vLyBUT0RPOiBVdGlsaXRpZXMgZm9yIGdldC9zZXQgdXNlciBmbGFnc1xyXG4vKipcclxuICogQSBjb2xsZWN0aW9uIG9mIG1ldGhvZHMgdXNlZCBmb3Igc2V0dGluZyB1cCB0aGUgQVBJICYgc3lzdGVtIHN0YXRlLlxyXG4gKiBAcHJpdmF0ZVxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFBERlNldHVwIHtcclxuICAgIC8qKlxyXG4gICAgICogUmVnaXN0ZXIgdGhlIFBERm91bmRyeSBBUGkgb24gdGhlIFVJXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgcmVnaXN0ZXJBUEkoKSB7XHJcbiAgICAgICAgdWlbJ1BERm91bmRyeSddID0gUERGb3VuZHJ5QVBJO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSW5qZWN0IHRoZSBDU1MgZmlsZSBpbnRvIHRoZSBoZWFkZXIsIHNvIGl0IGRvZXNuJ3QgaGF2ZSB0byBiZSByZWZlcmVuY2VkIGluIHRoZSBzeXN0ZW0uanNvblxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIHJlZ2lzdGVyQ1NTKCkge1xyXG4gICAgICAgICQoJ2hlYWQnKS5hcHBlbmQoXHJcbiAgICAgICAgICAgICQoYDxsaW5rIGhyZWY9XCJzeXN0ZW1zLyR7UERGU2V0dGluZ3MuRVhURVJOQUxfU1lTVEVNX05BTUV9LyR7UERGU2V0dGluZ3MuRElTVF9GT0xERVJ9L2J1bmRsZS5jc3NcIiByZWw9XCJzdHlsZXNoZWV0XCIgdHlwZT1cInRleHQvY3NzXCIgbWVkaWE9XCJhbGxcIj5gKSxcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHVsbHMgdGhlIHN5c3RlbSBuYW1lIGZyb20gdGhlIHNjcmlwdCB0YWdzLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIHJlZ2lzdGVyU3lzdGVtKCkge1xyXG4gICAgICAgIGNvbnN0IHNjcmlwdHMgPSAkKCdzY3JpcHQnKTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNjcmlwdHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3Qgc2NyaXB0ID0gc2NyaXB0cy5nZXQoaSkgYXMgSFRNTFNjcmlwdEVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IGZvbGRlcnMgPSBzY3JpcHQuc3JjLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGRpc3RJZHggPSBmb2xkZXJzLmluZGV4T2YoUERGU2V0dGluZ3MuRElTVF9GT0xERVIpO1xyXG4gICAgICAgICAgICBpZiAoZGlzdElkeCA9PT0gLTEpIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgaWYgKGZvbGRlcnNbZGlzdElkeCAtIDFdID09PSAncGRmb3VuZHJ5JykgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICBQREZTZXR0aW5ncy5FWFRFUk5BTF9TWVNURU1fTkFNRSA9IGZvbGRlcnNbZGlzdElkeCAtIDFdO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZWdpc3RlciB0aGUgUERGIHNoZWV0IGFuZCB1bnJlZ2lzdGVyIGludmFsaWQgc2hlZXQgdHlwZXMgZnJvbSBpdC5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBmb3VuZHJ5Q29uZmlnKCkge1xyXG4gICAgICAgIEl0ZW1zLnJlZ2lzdGVyU2hlZXQoUERGU2V0dGluZ3MuSU5URVJOQUxfTU9EVUxFX05BTUUsIFBERkl0ZW1TaGVldCwge1xyXG4gICAgICAgICAgICB0eXBlczogW1BERlNldHRpbmdzLlBERl9FTlRJVFlfVFlQRV0sXHJcbiAgICAgICAgICAgIG1ha2VEZWZhdWx0OiB0cnVlLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBVbnJlZ2lzdGVyIGFsbCBvdGhlciBpdGVtIHNoZWV0cyBmb3IgdGhlIFBERiBlbnRpdHlcclxuICAgICAgICBjb25zdCBwZGZvdW5kcnlLZXkgPSBgJHtQREZTZXR0aW5ncy5JTlRFUk5BTF9NT0RVTEVfTkFNRX0uJHtQREZJdGVtU2hlZXQubmFtZX1gO1xyXG4gICAgICAgIGNvbnN0IHNoZWV0cyA9IENPTkZJRy5JdGVtLnNoZWV0Q2xhc3Nlc1tQREZTZXR0aW5ncy5QREZfRU5USVRZX1RZUEVdO1xyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKHNoZWV0cykpIHtcclxuICAgICAgICAgICAgY29uc3Qgc2hlZXQgPSBzaGVldHNba2V5XTtcclxuICAgICAgICAgICAgLy8ga2VlcCB0aGUgUERGb3VuZHJ5IHNoZWV0XHJcbiAgICAgICAgICAgIGlmIChzaGVldC5pZCA9PT0gcGRmb3VuZHJ5S2V5KSB7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gaWQgaXMgTU9EVUxFLkNMQVNTX05BTUVcclxuICAgICAgICAgICAgY29uc3QgW21vZHVsZV0gPSBzaGVldC5pZC5zcGxpdCgnLicpO1xyXG4gICAgICAgICAgICBJdGVtcy51bnJlZ2lzdGVyU2hlZXQobW9kdWxlLCBzaGVldC5jbHMsIHtcclxuICAgICAgICAgICAgICAgIHR5cGVzOiBbUERGU2V0dGluZ3MuUERGX0VOVElUWV9UWVBFXSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IGFkZGl0aW9uYWwgY29udGV4dCBtZW51IGljb25zIGZvciBQREYgaXRlbXNcclxuICAgICAqIEBwYXJhbSBodG1sXHJcbiAgICAgKiBAcGFyYW0gb3B0aW9uc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGdldEl0ZW1Db250ZXh0T3B0aW9ucyhodG1sLCBvcHRpb25zOiBhbnlbXSkge1xyXG4gICAgICAgIGNvbnN0IGdldEl0ZW1Gcm9tQ29udGV4dCA9IChodG1sOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KTogSXRlbSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGlkID0gaHRtbC5kYXRhKCdlbnRpdHktaWQnKTtcclxuICAgICAgICAgICAgcmV0dXJuIGdhbWUuaXRlbXMuZ2V0KGlkKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpZiAoZ2FtZS51c2VyLmlzR00pIHtcclxuICAgICAgICAgICAgb3B0aW9ucy51bnNoaWZ0KHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IGdhbWUuaTE4bi5sb2NhbGl6ZSgnUERGT1VORFJZLkNPTlRFWFQuUHJlbG9hZFBERicpLFxyXG4gICAgICAgICAgICAgICAgaWNvbjogJzxpIGNsYXNzPVwiZmFzIGZhLWRvd25sb2FkIGZhLWZ3XCI+PC9pPicsXHJcbiAgICAgICAgICAgICAgICBjb25kaXRpb246IChlbnRpdHlIdG1sOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IGdldEl0ZW1Gcm9tQ29udGV4dChlbnRpdHlIdG1sKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS50eXBlICE9PSBQREZTZXR0aW5ncy5QREZfRU5USVRZX1RZUEUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgeyB1cmwgfSA9IGl0ZW0uZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1cmwgIT09ICcnO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrOiAoZW50aXR5SHRtbDogSlF1ZXJ5PEhUTUxFbGVtZW50PikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBnZXRJdGVtRnJvbUNvbnRleHQoZW50aXR5SHRtbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGRmID0gUERGVXRpbC5nZXRQREZEYXRhRnJvbUl0ZW0oaXRlbSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwZGYgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9UT0RPOiBFcnJvciBoYW5kbGluZ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB7IHVybCB9ID0gcGRmO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IFBERlByZWxvYWRFdmVudChudWxsLCBQREZVdGlsLmdldEFic29sdXRlVVJMKHVybCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LmVtaXQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgUERGQ2FjaGUucHJlbG9hZCh1cmwpO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBvcHRpb25zLnVuc2hpZnQoe1xyXG4gICAgICAgICAgICBuYW1lOiBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5DT05URVhULk9wZW5QREYnKSxcclxuICAgICAgICAgICAgaWNvbjogJzxpIGNsYXNzPVwiZmFyIGZhLWZpbGUtcGRmXCI+PC9pPicsXHJcbiAgICAgICAgICAgIGNvbmRpdGlvbjogKGVudGl0eUh0bWw6IEpRdWVyeTxIVE1MRWxlbWVudD4pID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBnZXRJdGVtRnJvbUNvbnRleHQoZW50aXR5SHRtbCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS50eXBlICE9PSBQREZTZXR0aW5ncy5QREZfRU5USVRZX1RZUEUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgeyB1cmwgfSA9IGl0ZW0uZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVybCAhPT0gJyc7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoZW50aXR5SHRtbDogSlF1ZXJ5PEhUTUxFbGVtZW50PikgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IGdldEl0ZW1Gcm9tQ29udGV4dChlbnRpdHlIdG1sKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBkZiA9IFBERlV0aWwuZ2V0UERGRGF0YUZyb21JdGVtKGl0ZW0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChwZGYgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAvL1RPRE86IEVycm9yIGhhbmRsaW5nXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIFBERm91bmRyeUFQSS5vcGVuUERGKHBkZiwgMSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyB1c2VyTG9naW4oKSB7XHJcbiAgICAgICAgbGV0IHZpZXdlZDtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICB2aWV3ZWQgPSBnYW1lLnVzZXIuZ2V0RmxhZyhQREZTZXR0aW5ncy5FWFRFUk5BTF9TWVNURU1fTkFNRSwgUERGU2V0dGluZ3MuSEVMUF9TRUVOX0tFWSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgdmlld2VkID0gZmFsc2U7XHJcbiAgICAgICAgfSBmaW5hbGx5IHtcclxuICAgICAgICAgICAgaWYgKCF2aWV3ZWQpIHtcclxuICAgICAgICAgICAgICAgIFBERm91bmRyeUFQSS5zaG93SGVscCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgYXN5bmMgcHJlQ3JlYXRlSXRlbShlbnRpdHksIC4uLmFyZ3MpIHtcclxuICAgICAgICBpZiAoZW50aXR5LnR5cGUgIT09IFBERlNldHRpbmdzLlBERl9FTlRJVFlfVFlQRSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVudGl0eS5pbWcgPSBgc3lzdGVtcy8ke1BERlNldHRpbmdzLkVYVEVSTkFMX1NZU1RFTV9OQU1FfS8ke1BERlNldHRpbmdzLkRJU1RfRk9MREVSfS9hc3NldHMvcGRmX2ljb24uc3ZnYDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIG9uUmVuZGVyU2V0dGluZ3Moc2V0dGluZ3M6IGFueSwgaHRtbDogSlF1ZXJ5PEhUTUxFbGVtZW50PiwgZGF0YTogYW55KSB7XHJcbiAgICAgICAgY29uc3QgaWNvbiA9ICc8aSBjbGFzcz1cImZhciBmYS1maWxlLXBkZlwiPjwvaT4nO1xyXG4gICAgICAgIGNvbnN0IGJ1dHRvbiA9ICQoYDxidXR0b24+JHtpY29ufSAke2dhbWUuaTE4bi5sb2NhbGl6ZSgnUERGT1VORFJZLlNFVFRJTkdTLk9wZW5IZWxwJyl9PC9idXR0b24+YCk7XHJcbiAgICAgICAgYnV0dG9uLm9uKCdjbGljaycsIFBERm91bmRyeUFQSS5zaG93SGVscCk7XHJcblxyXG4gICAgICAgIGh0bWwuZmluZCgnaDInKS5sYXN0KCkuYmVmb3JlKGJ1dHRvbik7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgUERGU2V0dGluZ3MgfSBmcm9tICcuLi9zZXR0aW5ncy9QREZTZXR0aW5ncyc7XHJcbmltcG9ydCB7IFBERlNldFZpZXdFdmVudCB9IGZyb20gJy4vZXZlbnRzL1BERlNldFZpZXdFdmVudCc7XHJcbmltcG9ydCB7IFBERm91bmRyeUFQSSB9IGZyb20gJy4uL2FwaS9QREZvdW5kcnlBUEknO1xyXG5pbXBvcnQgeyBQREZQcmVsb2FkRXZlbnQgfSBmcm9tICcuL2V2ZW50cy9QREZQcmVsb2FkRXZlbnQnO1xyXG5pbXBvcnQgeyBQREZDYWNoZSB9IGZyb20gJy4uL2NhY2hlL1BERkNhY2hlJztcclxuaW1wb3J0IHsgUERGRGF0YSB9IGZyb20gJy4uL2FwaS90eXBlcy9QREZEYXRhJztcclxuaW1wb3J0IHsgUERGVmlld2VyIH0gZnJvbSAnLi4vdmlld2VyL1BERlZpZXdlcic7XHJcblxyXG4vKipcclxuICogQHByaXZhdGVcclxuICovXHJcbmV4cG9ydCBjbGFzcyBQREZTb2NrZXRIYW5kbGVyIHtcclxuICAgIHB1YmxpYyBzdGF0aWMgcmVnaXN0ZXJIYW5kbGVycygpIHtcclxuICAgICAgICAvLyBAdHMtaWdub3JlXHJcbiAgICAgICAgZ2FtZS5zb2NrZXQub24oUERGU2V0dGluZ3MuU09DS0VUX05BTUUsIChldmVudCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB7IHVzZXJJZHMsIHR5cGUsIHBheWxvYWQgfSA9IGV2ZW50O1xyXG4gICAgICAgICAgICAvLyBudWxsID0gYWxsIHVzZXJzLCBvdGhlcndpc2UgY2hlY2sgaWYgdGhpcyBldmVudCBlZmZlY3RzIHVzXHJcbiAgICAgICAgICAgIGlmICh1c2VySWRzICE9PSBudWxsICYmICF1c2VySWRzLmluY2x1ZGVzKGdhbWUudXNlcklkKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gUERGU2V0Vmlld0V2ZW50LkVWRU5UX1RZUEUpIHtcclxuICAgICAgICAgICAgICAgIFBERlNvY2tldEhhbmRsZXIuaGFuZGxlU2V0VmlldyhwYXlsb2FkKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBQREZQcmVsb2FkRXZlbnQuRVZFTlRfVFlQRSkge1xyXG4gICAgICAgICAgICAgICAgUERGU29ja2V0SGFuZGxlci5oYW5kbGVQcmVsb2FkUERGKHBheWxvYWQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGUuaW5jbHVkZXMoJ1BERk9VTkRSWScpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRXZlbnQgb2YgdHlwZSAke3R5cGV9IGhhcyBubyBoYW5kbGVyLmApO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgaGFuZGxlU2V0VmlldyhkYXRhOiBhbnkpIHtcclxuICAgICAgICBpZiAoUERGU2V0dGluZ3MuZ2V0KFBERlNldHRpbmdzLlNFVFRJTkdfRVhJU1RJTkdfVklFV0VSKSkge1xyXG4gICAgICAgICAgICBmdW5jdGlvbiBhcHBJc1ZpZXdlcihhcHA6IEFwcGxpY2F0aW9uKTogYXBwIGlzIFBERlZpZXdlciB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYXBwWydwZGZEYXRhJ10gIT09IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZm9yIChjb25zdCBhcHAgb2YgT2JqZWN0LnZhbHVlcyh1aS53aW5kb3dzKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFhcHBJc1ZpZXdlcihhcHApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgcGRmRGF0YSA9IGFwcC5wZGZEYXRhO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEucGRmRGF0YS51cmwgPT09IHBkZkRhdGEudXJsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXBwLnBhZ2UgPSBkYXRhLnBhZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIEFwcCBub3QgZm91bmQsIGZhbGwgdGhyb3VnaC5cclxuICAgICAgICB9XHJcbiAgICAgICAgUERGb3VuZHJ5QVBJLm9wZW5QREYoZGF0YS5wZGZEYXRhLCBkYXRhLnBhZ2UpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgaGFuZGxlUHJlbG9hZFBERihkYXRhOiBhbnkpIHtcclxuICAgICAgICBQREZDYWNoZS5wcmVsb2FkKGRhdGEudXJsKTtcclxuICAgIH1cclxufVxyXG4iLCIvKiBDb3B5cmlnaHQgMjAyMCBBbmRyZXcgQ3VjY2luZWxsb1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcblxyXG5pbXBvcnQgeyBQREZTb2NrZXRFdmVudCB9IGZyb20gJy4vUERGU29ja2V0RXZlbnQnO1xyXG5cclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUERGUHJlbG9hZEV2ZW50IGV4dGVuZHMgUERGU29ja2V0RXZlbnQge1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXQgRVZFTlRfVFlQRSgpIHtcclxuICAgICAgICByZXR1cm4gYCR7c3VwZXIuRVZFTlRfVFlQRX0vUFJFTE9BRF9QREZgO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCB0eXBlKCkge1xyXG4gICAgICAgIHJldHVybiBQREZQcmVsb2FkRXZlbnQuRVZFTlRfVFlQRTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgdXJsOiBzdHJpbmc7XHJcblxyXG4gICAgY29uc3RydWN0b3IodXNlcklkczogc3RyaW5nW10gfCBudWxsLCB1cmw6IHN0cmluZykge1xyXG4gICAgICAgIHN1cGVyKHVzZXJJZHMpO1xyXG5cclxuICAgICAgICB0aGlzLnVybCA9IHVybDtcclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgZ2V0UGF5bG9hZCgpOiBhbnkge1xyXG4gICAgICAgIGNvbnN0IHBheWxvYWQgPSBzdXBlci5nZXRQYXlsb2FkKCk7XHJcbiAgICAgICAgcGF5bG9hZC51cmwgPSB0aGlzLnVybDtcclxuICAgICAgICByZXR1cm4gcGF5bG9hZDtcclxuICAgIH1cclxufVxyXG4iLCIvKiBDb3B5cmlnaHQgMjAyMCBBbmRyZXcgQ3VjY2luZWxsb1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcblxyXG5pbXBvcnQgeyBQREZTb2NrZXRFdmVudCB9IGZyb20gJy4vUERGU29ja2V0RXZlbnQnO1xyXG5pbXBvcnQgeyBQREZEYXRhIH0gZnJvbSAnLi4vLi4vYXBpL3R5cGVzL1BERkRhdGEnO1xyXG5cclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUERGU2V0Vmlld0V2ZW50IGV4dGVuZHMgUERGU29ja2V0RXZlbnQge1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXQgRVZFTlRfVFlQRSgpIHtcclxuICAgICAgICByZXR1cm4gYCR7c3VwZXIuRVZFTlRfVFlQRX0vU0VUX1ZJRVdgO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCB0eXBlKCkge1xyXG4gICAgICAgIHJldHVybiBQREZTZXRWaWV3RXZlbnQuRVZFTlRfVFlQRTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgcGFnZTogbnVtYmVyO1xyXG4gICAgcHVibGljIHBkZkRhdGE6IFBERkRhdGE7XHJcblxyXG4gICAgY29uc3RydWN0b3IodXNlcklkczogc3RyaW5nW10gfCBudWxsLCBwZGZEYXRhOiBQREZEYXRhLCBwYWdlOiBudW1iZXIpIHtcclxuICAgICAgICBzdXBlcih1c2VySWRzKTtcclxuXHJcbiAgICAgICAgdGhpcy5wZGZEYXRhID0gcGRmRGF0YTtcclxuICAgICAgICB0aGlzLnBhZ2UgPSBwYWdlO1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBnZXRQYXlsb2FkKCkge1xyXG4gICAgICAgIGNvbnN0IHBheWxvYWQgPSBzdXBlci5nZXRQYXlsb2FkKCk7XHJcbiAgICAgICAgcGF5bG9hZC5wZGZEYXRhID0gdGhpcy5wZGZEYXRhO1xyXG4gICAgICAgIHBheWxvYWQucGFnZSA9IHRoaXMucGFnZTtcclxuICAgICAgICByZXR1cm4gcGF5bG9hZDtcclxuICAgIH1cclxufVxyXG4iLCIvKiBDb3B5cmlnaHQgMjAyMCBBbmRyZXcgQ3VjY2luZWxsb1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcblxyXG5pbXBvcnQgeyBQREZTZXR0aW5ncyB9IGZyb20gJy4uLy4uL3NldHRpbmdzL1BERlNldHRpbmdzJztcclxuXHJcbi8qKlxyXG4gKiBAcHJpdmF0ZVxyXG4gKi9cclxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFBERlNvY2tldEV2ZW50IHtcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHR5cGUgb2YgdGhpcyBldmVudC5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXQgRVZFTlRfVFlQRSgpIHtcclxuICAgICAgICByZXR1cm4gJ1BERk9VTkRSWSc7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgdHlwZSBvZiB0aGlzIGV2ZW50LlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYWJzdHJhY3QgZ2V0IHR5cGUoKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFRoZSB1c2VyIGlkcyB0aGF0IHNob3VsZCBoYW5kbGUgdGhpcyBldmVudC5cclxuICAgICAqL1xyXG4gICAgcHJvdGVjdGVkIHVzZXJJZHM6IHN0cmluZ1tdIHwgbnVsbDtcclxuXHJcbiAgICBwcm90ZWN0ZWQgY29uc3RydWN0b3IodXNlcklkczogc3RyaW5nW10gfCBudWxsKSB7XHJcbiAgICAgICAgdGhpcy51c2VySWRzID0gdXNlcklkcztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCBhbnkgZGF0YSB0aGF0IHdpbGwgYmUgc2VudCB3aXRoIHRoZSBldmVudC5cclxuICAgICAqL1xyXG4gICAgcHJvdGVjdGVkIGdldFBheWxvYWQoKTogYW55IHtcclxuICAgICAgICByZXR1cm4ge307XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGVtaXQoKSB7XHJcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxyXG4gICAgICAgIGdhbWUuc29ja2V0LmVtaXQoUERGU2V0dGluZ3MuU09DS0VUX05BTUUsIHtcclxuICAgICAgICAgICAgdHlwZTogdGhpcy50eXBlLFxyXG4gICAgICAgICAgICB1c2VySWRzOiB0aGlzLnVzZXJJZHMsXHJcbiAgICAgICAgICAgIHBheWxvYWQ6IHRoaXMuZ2V0UGF5bG9hZCgpLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbiIsIi8qIENvcHlyaWdodCAyMDIwIEFuZHJldyBDdWNjaW5lbGxvXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFBERlNldHRpbmdzIH0gZnJvbSAnLi4vc2V0dGluZ3MvUERGU2V0dGluZ3MnO1xyXG5pbXBvcnQgeyBQREZFdmVudHMgfSBmcm9tICcuLi9hcGkvUERGRXZlbnRzJztcclxuaW1wb3J0IHsgUERGRGF0YSB9IGZyb20gJy4uL2FwaS90eXBlcy9QREZEYXRhJztcclxuaW1wb3J0IHsgUERGanNWaWV3ZXIgfSBmcm9tICcuLi90eXBlcy9QREZqc1ZpZXdlcic7XHJcbmltcG9ydCB7IFBERlNldFZpZXdFdmVudCB9IGZyb20gJy4uL3NvY2tldC9ldmVudHMvUERGU2V0Vmlld0V2ZW50JztcclxuaW1wb3J0IHsgUERGVXRpbCB9IGZyb20gJy4uL2FwaS9QREZVdGlsJztcclxuaW1wb3J0IHsgUERGanNFdmVudEJ1cyB9IGZyb20gJy4uL3R5cGVzL1BERmpzRXZlbnRCdXMnO1xyXG5pbXBvcnQgeyBQREZQbGF5ZXJTZWxlY3QgfSBmcm9tICcuLi9hcHAvUERGUGxheWVyU2VsZWN0JztcclxuXHJcbmV4cG9ydCBjbGFzcyBQREZWaWV3ZXIgZXh0ZW5kcyBBcHBsaWNhdGlvbiB7XHJcbiAgICBzdGF0aWMgZ2V0IGRlZmF1bHRPcHRpb25zKCkge1xyXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSBzdXBlci5kZWZhdWx0T3B0aW9ucztcclxuICAgICAgICBvcHRpb25zLmNsYXNzZXMgPSBbJ2FwcCcsICd3aW5kb3ctYXBwJywgJ3BkZm91bmRyeS12aWV3ZXInXTtcclxuICAgICAgICBvcHRpb25zLnRlbXBsYXRlID0gYHN5c3RlbXMvJHtQREZTZXR0aW5ncy5FWFRFUk5BTF9TWVNURU1fTkFNRX0vcGRmb3VuZHJ5LWRpc3QvdGVtcGxhdGVzL2FwcC9wZGYtdmlld2VyLmh0bWxgO1xyXG4gICAgICAgIG9wdGlvbnMudGl0bGUgPSBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5WSUVXRVIuVmlld1BERicpO1xyXG4gICAgICAgIG9wdGlvbnMud2lkdGggPSA4LjUgKiAxMDAgKyA2NDtcclxuICAgICAgICBvcHRpb25zLmhlaWdodCA9IDExICogMTAwICsgNjQ7XHJcbiAgICAgICAgb3B0aW9ucy5yZXNpemFibGUgPSB0cnVlO1xyXG4gICAgICAgIHJldHVybiBvcHRpb25zO1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBfZnJhbWU6IEhUTUxJRnJhbWVFbGVtZW50O1xyXG4gICAgcHJvdGVjdGVkIF92aWV3ZXI6IFBERmpzVmlld2VyO1xyXG4gICAgcHJvdGVjdGVkIF9ldmVudEJ1czogUERGanNFdmVudEJ1cztcclxuICAgIHByb3RlY3RlZCBfcGRmRGF0YTogUERGRGF0YTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihwZGZEYXRhPzogUERGRGF0YSwgb3B0aW9ucz86IEFwcGxpY2F0aW9uT3B0aW9ucykge1xyXG4gICAgICAgIHN1cGVyKG9wdGlvbnMpO1xyXG5cclxuICAgICAgICBpZiAocGRmRGF0YSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHBkZkRhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5WSUVXRVIuVGl0bGUnKSxcclxuICAgICAgICAgICAgICAgIGNvZGU6ICcnLFxyXG4gICAgICAgICAgICAgICAgb2Zmc2V0OiAwLFxyXG4gICAgICAgICAgICAgICAgdXJsOiAnJyxcclxuICAgICAgICAgICAgICAgIGNhY2hlOiBmYWxzZSxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuX3BkZkRhdGEgPSBwZGZEYXRhO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiR2V0dGVycyAmIFNldHRlcnNcIj5cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgYSBjb3B5IG9mIHRoZSBQREZEYXRhIHRoaXMgdmlld2VyIGlzIHVzaW5nLlxyXG4gICAgICogQ2hhbmdlcyB0byB0aGlzIGRhdGEgd2lsbCBub3QgcmVmbGVjdCBpbiB0aGUgdmlld2VyLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0IHBkZkRhdGEoKSB7XHJcbiAgICAgICAgcmV0dXJuIGR1cGxpY2F0ZSh0aGlzLl9wZGZEYXRhKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0IHBhZ2UoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZpZXdlci5wYWdlO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzZXQgcGFnZSh2YWx1ZTogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5fdmlld2VyLnBhZ2UgPSB2YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyA8L2VkaXRvci1mb2xkPlxyXG5cclxuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiRm91bmRyeSBPdmVycmlkZXNcIj5cclxuXHJcbiAgICBnZXQgdGl0bGUoKTogc3RyaW5nIHtcclxuICAgICAgICBsZXQgdGl0bGUgPSB0aGlzLl9wZGZEYXRhLm5hbWU7XHJcbiAgICAgICAgaWYgKHRoaXMuX3BkZkRhdGEuY29kZSAhPT0gJycpIHtcclxuICAgICAgICAgICAgdGl0bGUgPSBgJHt0aXRsZX0gKCR7dGhpcy5fcGRmRGF0YS5jb2RlfSlgO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGl0bGU7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIF9nZXRIZWFkZXJCdXR0b25zKCk6IGFueVtdIHtcclxuICAgICAgICBjb25zdCBidXR0b25zID0gc3VwZXIuX2dldEhlYWRlckJ1dHRvbnMoKTtcclxuICAgICAgICAvL1RPRE86IFN0YW5kYXJkaXplIHRoaXMgdG8gZnVuY3Rpb24gdy8gdGhlIEl0ZW0gc2hlZXQgb25lXHJcbiAgICAgICAgYnV0dG9ucy51bnNoaWZ0KHtcclxuICAgICAgICAgICAgY2xhc3M6ICdwZGYtc2hlZXQtZ2l0aHViJyxcclxuICAgICAgICAgICAgaWNvbjogJ2ZhcyBmYS1leHRlcm5hbC1saW5rLWFsdCcsXHJcbiAgICAgICAgICAgIGxhYmVsOiAnUERGb3VuZHJ5JyxcclxuICAgICAgICAgICAgb25jbGljazogKCkgPT4gd2luZG93Lm9wZW4oJ2h0dHBzOi8vZ2l0aHViLmNvbS9EanBob2VuaXg3MTkvUERGb3VuZHJ5JywgJ19ibGFuaycpLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBidXR0b25zLnVuc2hpZnQoe1xyXG4gICAgICAgICAgICBjbGFzczogJ3BkZi1zaGVldC1zaG93LXBsYXllcnMnLFxyXG4gICAgICAgICAgICBpY29uOiAnZmFzIGZhLWV5ZScsXHJcbiAgICAgICAgICAgIGxhYmVsOiBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5WSUVXRVIuU2hvd1RvUGxheWVyc1RleHQnKSxcclxuICAgICAgICAgICAgb25jbGljazogKGV2ZW50KSA9PiB0aGlzLnNob3dUbyhldmVudCksXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBidXR0b25zO1xyXG4gICAgfVxyXG5cclxuICAgIGdldERhdGEob3B0aW9ucz86IGFueSk6IGFueSB8IFByb21pc2U8YW55PiB7XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IHN1cGVyLmdldERhdGEob3B0aW9ucyk7XHJcbiAgICAgICAgZGF0YS5zeXN0ZW1OYW1lID0gUERGU2V0dGluZ3MuRVhURVJOQUxfU1lTVEVNX05BTUU7XHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIGFzeW5jIGFjdGl2YXRlTGlzdGVuZXJzKGh0bWw6IEpRdWVyeTxIVE1MRWxlbWVudD4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICBzdXBlci5hY3RpdmF0ZUxpc3RlbmVycyhodG1sKTtcclxuXHJcbiAgICAgICAgdGhpcy5fZnJhbWUgPSBodG1sLnBhcmVudCgpLmZpbmQoJ2lmcmFtZS5wZGZWaWV3ZXInKS5nZXQoMCkgYXMgSFRNTElGcmFtZUVsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy5nZXRWaWV3ZXIoKS50aGVuKGFzeW5jICh2aWV3ZXIpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fdmlld2VyID0gdmlld2VyO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5nZXRFdmVudEJ1cygpLnRoZW4oKGV2ZW50QnVzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9ldmVudEJ1cyA9IGV2ZW50QnVzO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGNvbnN0IGxpc3RlbmVycyA9IGV2ZW50QnVzLl9saXN0ZW5lcnM7XHJcbiAgICAgICAgICAgICAgICAvLyBmb3IgKGNvbnN0IGV2ZW50TmFtZSBvZiBPYmplY3Qua2V5cyhsaXN0ZW5lcnMpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgZXZlbnRCdXMub24oZXZlbnROYW1lLCAoLi4uYXJncykgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB0aGlzLmxvZ0V2ZW50KGV2ZW50TmFtZSwgYXJncyk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gRmlyZSB0aGUgdmlld2VyUmVhZHkgZXZlbnQgc28gdGhlIHZpZXdlciBtYXkgYmUgdXNlZCBleHRlcm5hbGx5XHJcbiAgICAgICAgICAgICAgICBQREZFdmVudHMuZmlyZSgndmlld2VyUmVhZHknLCB0aGlzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIF9nZXRIZWFkZXJCdXR0b25zIGRvZXMgbm90IHBlcm1pdCB0aXRsZXMuLi5cclxuICAgICAgICAkKGh0bWwpLnBhcmVudHMoKS5wYXJlbnRzKCkuZmluZCgnLnBkZi1zaGVldC1zaG93LXBsYXllcnMnKS5wcm9wKCd0aXRsZScsIGdhbWUuaTE4bi5sb2NhbGl6ZSgnUERGT1VORFJZLlZJRVdFUi5TaG93VG9QbGF5ZXJzVGl0bGUnKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gcHJpdmF0ZSBsb2dFdmVudChrZXk6IHN0cmluZywgLi4uYXJncykge1xyXG4gICAgLy8gICAgIGNvbnNvbGUuZGVidWcoa2V5KTtcclxuICAgIC8vICAgICBjb25zb2xlLmRlYnVnKGFyZ3MpO1xyXG4gICAgLy8gfVxyXG5cclxuICAgIGFzeW5jIGNsb3NlKCk6IFByb21pc2U8YW55PiB7XHJcbiAgICAgICAgUERGRXZlbnRzLmZpcmUoJ3ZpZXdlckNsb3NlJywgdGhpcyk7XHJcbiAgICAgICAgcmV0dXJuIHN1cGVyLmNsb3NlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNob3cgdGhlIGN1cnJlbnQgcGFnZSB0byBHTXMuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgc2hvd1RvKGV2ZW50OiBNb3VzZUV2ZW50KSB7XHJcbiAgICAgICAgY29uc3QgcGRmRGF0YSA9IHRoaXMucGRmRGF0YTtcclxuICAgICAgICBwZGZEYXRhLm9mZnNldCA9IDA7XHJcblxyXG4gICAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgICBjb25zdCBpZHMgPSBQREZVdGlsLmdldFVzZXJJZHNFeGNlcHRNZSgpO1xyXG4gICAgICAgIGlmIChldmVudC5zaGlmdEtleSkge1xyXG4gICAgICAgICAgICBuZXcgUERGU2V0Vmlld0V2ZW50KGlkcywgcGRmRGF0YSwgdGhpcy5wYWdlKS5lbWl0KCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbmV3IFBERlBsYXllclNlbGVjdChpZHMsIChmaWx0ZXJlZElkcykgPT4ge1xyXG4gICAgICAgICAgICAgICAgbmV3IFBERlNldFZpZXdFdmVudChmaWx0ZXJlZElkcywgcGRmRGF0YSwgdGhpcy5wYWdlKS5lbWl0KCk7XHJcbiAgICAgICAgICAgIH0pLnJlbmRlcih0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBXYWl0IGZvciB0aGUgaW50ZXJuYWwgUERGanMgdmlld2VyIHRvIGJlIHJlYWR5IGFuZCB1c2FibGUuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZ2V0Vmlld2VyKCk6IFByb21pc2U8UERGanNWaWV3ZXI+IHtcclxuICAgICAgICBpZiAodGhpcy5fdmlld2VyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5fdmlld2VyKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZTxhbnk+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgbGV0IHRpbWVvdXQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHJldHVybk9yV2FpdCA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIElmIG91ciB3aW5kb3cgaGFzIGZpbmlzaGVkIGluaXRpYWxpemluZy4uLlxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2ZyYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgUERGanMgaGFzIGZpbmlzaGVkIGluaXRpYWxpemluZy4uLlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9mcmFtZS5jb250ZW50V2luZG93ICYmIHRoaXMuX2ZyYW1lLmNvbnRlbnRXaW5kb3dbJ1BERlZpZXdlckFwcGxpY2F0aW9uJ10pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgdmlld2VyID0gdGhpcy5fZnJhbWUuY29udGVudFdpbmRvd1snUERGVmlld2VyQXBwbGljYXRpb24nXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh2aWV3ZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIElmIGFueSBpZnMgZmFsbCB0aHJvdWdoLCB0cnkgYWdhaW4gaW4gYSBmZXcgbXNcclxuICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KHJldHVybk9yV2FpdCwgNSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHJldHVybk9yV2FpdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogV2FpdCBmb3IgdGhlIGludGVybmFsIFBERmpzIGV2ZW50QnVzIHRvIGJlIHJlYWR5IGFuZCB1c2FibGUuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZ2V0RXZlbnRCdXMoKTogUHJvbWlzZTxQREZqc0V2ZW50QnVzPiB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2V2ZW50QnVzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5fZXZlbnRCdXMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPGFueT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmdldFZpZXdlcigpLnRoZW4oKHZpZXdlcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IHRpbWVvdXQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByZXR1cm5PcldhaXQgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdlci5ldmVudEJ1cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHZpZXdlci5ldmVudEJ1cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQocmV0dXJuT3JXYWl0LCA1KTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICByZXR1cm5PcldhaXQoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBGaW5pc2ggdGhlIGRvd25sb2FkIGFuZCByZXR1cm4gdGhlIGJ5dGUgYXJyYXkgZm9yIHRoZSBmaWxlLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZG93bmxvYWQoKTogUHJvbWlzZTxVaW50OEFycmF5PiB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPFVpbnQ4QXJyYXk+KGFzeW5jIChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgdmlld2VyID0gYXdhaXQgdGhpcy5nZXRWaWV3ZXIoKTtcclxuICAgICAgICAgICAgbGV0IHRpbWVvdXQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHJldHVybk9yV2FpdCA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh2aWV3ZXIuZG93bmxvYWRDb21wbGV0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUodmlld2VyLnBkZkRvY3VtZW50LmdldERhdGEoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KHJldHVybk9yV2FpdCwgNTApO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICByZXR1cm5PcldhaXQoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgYXN5bmMgb3BlbihwZGZTb3VyY2U6IHN0cmluZyB8IFVpbnQ4QXJyYXksIHBhZ2U/OiBudW1iZXIpIHtcclxuICAgICAgICBjb25zdCBwZGZqc1ZpZXdlciA9IGF3YWl0IHRoaXMuZ2V0Vmlld2VyKCk7XHJcblxyXG4gICAgICAgIGlmIChwYWdlKSB7XHJcbiAgICAgICAgICAgIHBkZmpzVmlld2VyLmluaXRpYWxCb29rbWFyayA9IGBwYWdlPSR7cGFnZX1gO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYXdhaXQgcGRmanNWaWV3ZXIub3BlbihwZGZTb3VyY2UpO1xyXG4gICAgfVxyXG59XHJcbiJdfQ=="}